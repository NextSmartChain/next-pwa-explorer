{"remainingRequest":"/mnt/websites/ex.nextsmartchain.com/node_modules/vue-loader/lib/index.js??vue-loader-options!/mnt/websites/ex.nextsmartchain.com/src/components/core/FWindow/FWindow.vue?vue&type=script&lang=js&","dependencies":[{"path":"/mnt/websites/ex.nextsmartchain.com/src/components/core/FWindow/FWindow.vue","mtime":1657708591926},{"path":"/mnt/websites/ex.nextsmartchain.com/node_modules/babel-loader/lib/index.js","mtime":1655491285588},{"path":"/mnt/websites/ex.nextsmartchain.com/node_modules/cache-loader/dist/cjs.js","mtime":1655491106804},{"path":"/mnt/websites/ex.nextsmartchain.com/node_modules/vue-loader/lib/index.js","mtime":1657708714280}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IGdldExlbmd0aEFuZFVuaXQsIGdldENvbXB1dGVkU3R5bGUgfSBmcm9tICcuLi8uLi8uLi91dGlscy9jc3MuanMnOwppbXBvcnQgeyBnZXRVbmlxdWVJZCwgdGhyb3R0bGUgfSBmcm9tICcuLi8uLi8uLi91dGlscy9pbmRleC5qcyc7CmltcG9ydCBGT3ZlcmxheSBmcm9tICcuLi9GT3ZlcmxheS9GT3ZlcmxheS52dWUnOwppbXBvcnQgeyBmb2N1c1RyYXAsIGlzS2V5LCByZXR1cm5Gb2N1cywgc2V0UmVjZWl2ZUZvY3VzRnJvbUF0dHIgfSBmcm9tICcuLi8uLi8uLi91dGlscy9hcmlhLmpzJzsKaW1wb3J0IFJlc2l6ZU9ic2VydmVyIGZyb20gJ3Jlc2l6ZS1vYnNlcnZlci1wb2x5ZmlsbCc7CmltcG9ydCB7IGhlbHBlcnNNaXhpbiB9IGZyb20gJy4uLy4uLy4uL21peGlucy9oZWxwZXJzLmpzJzsKaW1wb3J0IHsKICAgIGF0dGFjaEVsZW1UbywKICAgIGdldEFsaWdubWVudCwKICAgIGdldEF0dGFjaFBvc2l0aW9uLAogICAgZ2V0QXR0YWNoUG9zaXRpb25CeVJlY3RzLAogICAgZ2V0QXV0b0F0dGFjaFBvc2l0aW9uLAogICAgZ2V0RWxlbVJlY3QsCn0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvRE9NLmpzJzsKCi8qKgogKiBCYXNpYyB3aW5kb3cgZm9sbG93aW5nIFdBSS1BUklBIHByYWN0aWNlcy4KICogTmVlZHMgYHJlc2l6ZS1vYnNlcnZlci1wb2x5ZmlsbGAgcGx1Z2luLgogKi8KZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ0ZXaW5kb3cnLAoKICAgIGNvbXBvbmVudHM6IHsgRk92ZXJsYXkgfSwKCiAgICBtaXhpbnM6IFtoZWxwZXJzTWl4aW5dLAoKICAgIHByb3BzOiB7CiAgICAgICAgLyoqIElzIHdpbmRvdyB2aXNpYmxlIG9uIGluaXRpYWxpemF0aW9uPyAqLwogICAgICAgIHZpc2libGU6IHsKICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICAgICAgfSwKICAgICAgICAvKiogVGl0bGUgb2Ygd2luZG93IHJlbmRlcmVkIGluIGhlYWRlci4gKi8KICAgICAgICB0aXRsZTogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6ICcnLAogICAgICAgIH0sCiAgICAgICAgLyoqIEhhcyB3aW5kb3cgYSB0aXRsZT8gKi8KICAgICAgICBub1RpdGxlOiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgIH0sCiAgICAgICAgLyoqIEFuaW1hdGlvbiB0aGF0IHN0YXJ0cyB3aGVuIHRoZSB3aW5kb3cgaXMganVzdCBhYm91dCB0byBzaG93LiAqLwogICAgICAgIGFuaW1hdGlvbkluOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJ2ZhZGUtZW50ZXItYWN0aXZlJywKICAgICAgICB9LAogICAgICAgIC8qKiBBbmltYXRpb24gdGhhdCBzdGFydHMgd2hlbiB0aGUgd2luZG93IGlzIGp1c3QgYWJvdXQgdG8gaGlkZS4gKi8KICAgICAgICBhbmltYXRpb25PdXQ6IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgICAgICBkZWZhdWx0OiAnZmFkZS1sZWF2ZS1hY3RpdmUnLAogICAgICAgIH0sCiAgICAgICAgLyoqIFdBSS1BUklBIHJvbGUuICovCiAgICAgICAgcm9sZTogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6ICdkaWFsb2cnLAogICAgICAgIH0sCiAgICAgICAgLyoqIElzIHdpbmRvdyBhIG1vZGFsPyAqLwogICAgICAgIG1vZGFsOiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgIH0sCiAgICAgICAgLyoqIElzIHdpbmRvdyBhIHBvcG92ZXI/ICovCiAgICAgICAgcG9wb3ZlcjogewogICAgICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgICAgICBkZWZhdWx0OiBmYWxzZSwKICAgICAgICB9LAogICAgICAgIC8qKiBgPGhlYWRlcj5gIHdpbGwgYmUgcmVuZGVyZWQuICovCiAgICAgICAgd2l0aEhlYWRlcjogewogICAgICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgICAgICBkZWZhdWx0OiB0cnVlLAogICAgICAgIH0sCiAgICAgICAgLyoqIGA8Zm9vdGVyPmAgd2lsbCBiZSByZW5kZXJlZC4gKi8KICAgICAgICB3aXRoRm9vdGVyOiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgIH0sCiAgICAgICAgLyoqIGBGT3ZlcmxheWAgc2hvd3MuICovCiAgICAgICAgd2l0aE92ZXJsYXk6IHsKICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgICAgICAgZGVmYXVsdDogdHJ1ZSwKICAgICAgICB9LAogICAgICAgIC8qKiAnZml4ZWQnIHwgJ2Fic29sdXRlJyAqLwogICAgICAgIHBvc2l0aW9uOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJ2ZpeGVkJywKICAgICAgICB9LAogICAgICAgIC8qKiBgei1pbmRleGAgb2Ygd2luZG93LCBpZiBvdmVybGF5IGlzIHVzZWQsIGl0IGhhcyBgei1pbmRleGAgYHpJbmRleCAtMWAuICovCiAgICAgICAgekluZGV4OiB7CiAgICAgICAgICAgIHR5cGU6IE51bWJlciwKICAgICAgICAgICAgZGVmYXVsdDogMTAsCiAgICAgICAgfSwKICAgICAgICAvKiogQ1NTIHNlbGVjdG9yLiBJZiB3aW5kb3cgaXMgcG9wb3ZlciwgaXQgd2lsbCBiZSBhdHRhY2hlZCB0byBlbGVtbmV0IGdpdmVuIGJ5IHRoaXMgc2VsZWN0b3IuICovCiAgICAgICAgYXR0YWNoVG86IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgICAgICBkZWZhdWx0OiAnJywKICAgICAgICB9LAogICAgICAgIC8qKgogICAgICAgICAqIEhvdyB0byBwbGFjZSBwb3BvdmVyIHRvIGBhdHRhY2hUb2AgZWxlbWVudC4gKGAndG9wJ2AsIGAncmlnaHQnYCwgYCdib3R0b20nYCwgYCdsZWZ0J2AsIGAnYXV0bydgLCBgJ1tsY3JtXVt0Y2JtXSBbbGNybV1bdGNibV0nYCkKICAgICAgICAgKgogICAgICAgICAqIEB0eXBlIHsoJ3RvcCcsICdyaWdodCcsICdib3R0b20nLCAnbGVmdCcsICdhdXRvJywgJ1tsY3JtXVt0Y2JtXSBbbGNybV1bdGNibV0nKX0KICAgICAgICAgKi8KICAgICAgICBhdHRhY2hQb3NpdGlvbjogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6ICcnLAogICAgICAgIH0sCiAgICAgICAgLyoqCiAgICAgICAgICogUHJlZmVyZWQgYXR0YWNoIHBvc2l0aW9uLCBpZiBgYXR0YWNoUG9zaXRpb25gIGlzIGAnYXV0bydgLiAoYCd0b3AnYCwgYCdyaWdodCdgLCBgJ2JvdHRvbSdgLCBgJ2xlZnQnYCwgYCdhdXRvJ2AsIGAnW2xjcm1dW3RjYm1dIFtsY3JtXVt0Y2JtXSdgKQogICAgICAgICAqCiAgICAgICAgICogQHR5cGUgeygndG9wJywgJ3JpZ2h0JywgJ2JvdHRvbScsICdsZWZ0JywgJ2F1dG8nLCAnW2xjcm1dW3RjYm1dIFtsY3JtXVt0Y2JtXScpfQogICAgICAgICAqLwogICAgICAgIHByZWZlcnJlZEF0dGFjaFBvc2l0aW9uOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJycsCiAgICAgICAgfSwKICAgICAgICAvKioKICAgICAgICAgKiBNYXJnaW4gb2YgcG9wb3Zlci4gKGBbdG9wLCByaWdodCwgYm90dG9tLCBsZWZ0XWApCiAgICAgICAgICoKICAgICAgICAgKiBAdHlwZSB7W251bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlcl19CiAgICAgICAgICovCiAgICAgICAgYXR0YWNoTWFyZ2luOiB7CiAgICAgICAgICAgIHR5cGU6IEFycmF5LAogICAgICAgICAgICBkZWZhdWx0KCkgewogICAgICAgICAgICAgICAgcmV0dXJuIFswLCAwLCAwLCAwXTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdmFsaWRhdG9yOiBmdW5jdGlvbiAoX3ZhbHVlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3ZhbHVlLmxlbmd0aCA9PT0gNDsKICAgICAgICAgICAgfSwKICAgICAgICB9LAogICAgICAgIC8qKiBIaWRlIHdpbmRvdyBhZnRlciB0aGlzIGFtb3V0IG9mIG1pbGxpc2Vjb25kcy4gMCBtZWFucyBubyBhdXRvIGhpZGluZy4gKi8KICAgICAgICBoaWRlQWZ0ZXI6IHsKICAgICAgICAgICAgdHlwZTogTnVtYmVyLAogICAgICAgICAgICBkZWZhdWx0OiAwLAogICAgICAgIH0sCiAgICAgICAgLyoqIENlbnRlciB3aW5kb3cgaG9yaXpvbnRhbGx5LiAqLwogICAgICAgIGNlbnRlckhvcml6b250YWxseTogewogICAgICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgICAgICBkZWZhdWx0OiB0cnVlLAogICAgICAgIH0sCiAgICAgICAgLyoqIENlbnRlciB3aW5kb3cgdmVydGljYWxseS4gKi8KICAgICAgICBjZW50ZXJWZXJ0aWNhbGx5OiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIGRlZmF1bHQ6IHRydWUsCiAgICAgICAgfSwKICAgICAgICAvKiogTWFrZSB3aW5kb3cgc3RheSBpbiB2aWV3cG9ydC4gKi8KICAgICAgICBzdGF5SW5WaWV3cG9ydDogewogICAgICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgICAgICBkZWZhdWx0OiB0cnVlLAogICAgICAgIH0sCiAgICAgICAgLyoqIEhpZGUgd2luZG93IHdoZW4gYnJvd3NlciB3aW5kb3cgaXMgcmVzaXplZC4gKi8KICAgICAgICBoaWRlT25XaW5kb3dSZXNpemU6IHsKICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICAgICAgfSwKICAgICAgICAvKiogSGlkZSB3aW5kb3cgb24gYnJvd3NlciB3aW5kb3cgbW91c2Vkb3duLiAqLwogICAgICAgIGhpZGVPbldpbmRvd01vdXNlZG93bjogewogICAgICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgICAgICBkZWZhdWx0OiBmYWxzZSwKICAgICAgICB9LAogICAgICAgIC8qKiBIaWRlIHdpbmRvdyB3aGVuIGVzY2FwZSBrZXkgaXMgcHJlc3NlZC4gKi8KICAgICAgICBoaWRlT25Fc2NhcGVLZXk6IHsKICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgICAgICAgZGVmYXVsdDogdHJ1ZSwKICAgICAgICB9LAogICAgfSwKCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGlkOiBnZXRVbmlxdWVJZCgpLAogICAgICAgICAgICBpc1Zpc2libGU6IGZhbHNlLAogICAgICAgICAgICBkUG9zaXRpb246IHRoaXMucG9wb3ZlciA/ICdhYnNvbHV0ZScgOiB0aGlzLnBvc2l0aW9uLAogICAgICAgICAgICBkQW5pbWF0aW9uSW46IHRoaXMuYW5pbWF0aW9uSW4sCiAgICAgICAgICAgIGRBbmltYXRpb25PdXQ6IHRoaXMuYW5pbWF0aW9uT3V0LAogICAgICAgICAgICBkWkluZGV4OiB0aGlzLnpJbmRleCwKICAgICAgICAgICAgZFdpdGhPdmVybGF5OiB0aGlzLnBvcG92ZXIgPyBmYWxzZSA6IHRoaXMud2l0aE92ZXJsYXksCiAgICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgICAgICB6SW5kZXg6IHRoaXMuekluZGV4LAogICAgICAgICAgICB9LAogICAgICAgIH07CiAgICB9LAoKICAgIGNvbXB1dGVkOiB7CiAgICAgICAgY3NzQ2xhc3MoKSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAncG9zLWFic29sdXRlJzogdGhpcy5kUG9zaXRpb24gPT09ICdhYnNvbHV0ZScsCiAgICAgICAgICAgICAgICAncG9zLWZpeGVkJzogdGhpcy5kUG9zaXRpb24gPT09ICdmaXhlZCcsCiAgICAgICAgICAgICAgICAnd2l0aC1oZWFkZXInOiB0aGlzLndpdGhIZWFkZXIsCiAgICAgICAgICAgICAgICAnd2l0aC1mb290ZXInOiB0aGlzLndpdGhGb290ZXIsCiAgICAgICAgICAgICAgICAnbm8tdGl0bGUnOiB0aGlzLm5vVGl0bGUsCiAgICAgICAgICAgICAgICBtb2RhbDogdGhpcy5tb2RhbCwKICAgICAgICAgICAgICAgIHBvcG92ZXI6IHRoaXMucG9wb3ZlciwKICAgICAgICAgICAgfTsKICAgICAgICB9LAogICAgfSwKCiAgICB3YXRjaDogewogICAgICAgIHZpc2libGUoX3ZhbHVlKSB7CiAgICAgICAgICAgIHRoaXMuaXNWaXNpYmxlID0gX3ZhbHVlOwogICAgICAgIH0sCiAgICB9LAoKICAgIGNyZWF0ZWQoKSB7CiAgICAgICAgLyoqIEluaXRpYWwgY3NzIHZhbHVlcyBvZiB3aW5kb3cuICovCiAgICAgICAgdGhpcy5fd2luZG93U3R5bGUgPSB7CiAgICAgICAgICAgIHRvcDogMCwKICAgICAgICAgICAgbGVmdDogMCwKICAgICAgICAgICAgd2lkdGg6IDAsCiAgICAgICAgICAgIG1heFdpZHRoOiAwLAogICAgICAgICAgICBtaW5XaWR0aDogMCwKICAgICAgICAgICAgaGVpZ2h0OiAwLAogICAgICAgICAgICBtYXhIZWlnaHQ6IDAsCiAgICAgICAgICAgIG1pbkhlaWdodDogMCwKICAgICAgICAgICAgLyoKICAgICAgICAgICAgYm9yZGVyVG9wTGVmdFJhZGl1czogMCwKICAgICAgICAgICAgYm9yZGVyVG9wUmlnaHRSYWRpdXM6IDAsCiAgICAgICAgICAgIGJvcmRlckJvdHRvbUxlZnRSYWRpdXM6IDAsCiAgICAgICAgICAgIGJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzOiAwLAogICAgICAgICAgICAqLwogICAgICAgICAgICBfaG9ySGFsZk1hcmdpblNldDogZmFsc2UsIC8vIGhlbHBlcgogICAgICAgICAgICBfdmVySGFsZk1hcmdpblNldDogZmFsc2UsIC8vIGhlbHBlcgogICAgICAgIH07CiAgICAgICAgLyoqIFZhcmlvdXMgaWRzLiAqLwogICAgICAgIHRoaXMuX2lkcyA9IHsKICAgICAgICAgICAgY29tcDogYGZ3aW4tJHt0aGlzLl91aWR9YCwKICAgICAgICAgICAgdGl0bGU6IGBmd2luLXRpdGxlLSR7dGhpcy5fdWlkfWAsCiAgICAgICAgICAgIGJvZHk6IGBmd2luLWJvZHktJHt0aGlzLl91aWR9YCwKICAgICAgICB9OwogICAgICAgIC8qKiBEZWJvdW5jZSBmdW5jdGlvbiB1c2VkIGFzIHdpbmRvdyByZXNpemUgY2FsbGJhY2suICovCiAgICAgICAgdGhpcy5fcmVzaXplQ2FsbGJhY2sgPSB0aHJvdHRsZSgoX2V2ZW50KSA9PiB0aGlzLm9uV2luZG93UmVzaXplKF9ldmVudCksIDMwMCwgdHJ1ZSk7CiAgICAgICAgLyoqIEluc3RhbmNlIG9mIFJlc2l6ZU9ic2VydmVyLiAqLwogICAgICAgIHRoaXMuX3Jlc2l6ZU9ic2VydmVyID0gbnVsbDsKICAgICAgICAvKiogU3RvcmVzIGZpcnN0IGFuZCBsYXN0IGZvY3VzYWJsZSBlbGVtZW50cyBpbiB3aW5kb3cuICovCiAgICAgICAgdGhpcy5fZmlyc3RMYXN0Rm9jdXNhYmxlcyA9IHsKICAgICAgICAgICAgZmlyc3Q6IG51bGwsCiAgICAgICAgICAgIGxhc3Q6IG51bGwsCiAgICAgICAgfTsKICAgICAgICAvKiogYGhpZGVBZnRlcmAgdGltZW91dCBpZC4gKi8KICAgICAgICB0aGlzLl9oaWRlQWZ0ZXJJZCA9IC0xOwogICAgfSwKCiAgICBtb3VudGVkKCkgewogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy4kZWwpOwoKICAgICAgICBpZiAodGhpcy5oaWRlT25XaW5kb3dSZXNpemUpIHsKICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuX3Jlc2l6ZUNhbGxiYWNrLCBmYWxzZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5oaWRlT25XaW5kb3dNb3VzZWRvd24pIHsKICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMub25XaW5kb3dNb3VzZWRvd24sIGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnZpc2libGUpIHsKICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5zaG93KCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0sCgogICAgYmVmb3JlRGVzdHJveSgpIHsKICAgICAgICB0aGlzLl9maXJzdExhc3RGb2N1c2FibGVzID0gbnVsbDsKCiAgICAgICAgaWYgKHRoaXMuaGlkZU9uV2luZG93UmVzaXplKSB7CiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLl9yZXNpemVDYWxsYmFjayk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5oaWRlT25XaW5kb3dNb3VzZWRvd24pIHsKICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMub25XaW5kb3dNb3VzZWRvd24pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jbGVhckhpZGVBZnRlclRpbWVvdXQoKTsKCiAgICAgICAgdGhpcy5kZXN0cm95UmVzaXplT2JzZXJ2ZXIoKTsKICAgIH0sCgogICAgZGVzdHJveWVkKCkgewogICAgICAgIHRoaXMuJGVsLnJlbW92ZSgpOwogICAgfSwKCiAgICBtZXRob2RzOiB7CiAgICAgICAgc2hvdyhfYW5pbWF0aW9uSW4pIHsKICAgICAgICAgICAgaWYgKCF0aGlzLmlzVmlzaWJsZSkgewogICAgICAgICAgICAgICAgY29uc3QgcGFyZW50V2luZG93ID0gdGhpcy5maW5kUGFyZW50QnlOYW1lKCdmLXdpbmRvdycpOwoKICAgICAgICAgICAgICAgIGlmIChwYXJlbnRXaW5kb3cpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRaSW5kZXggPSBwYXJlbnRXaW5kb3cuZFpJbmRleCArIDI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlU3R5bGUoeyB6SW5kZXg6IHRoaXMuZFpJbmRleCB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoX2FuaW1hdGlvbkluKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kQW5pbWF0aW9uSW4gPSBfYW5pbWF0aW9uSW47CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZEFuaW1hdGlvbkluID0gdGhpcy5hbmltYXRpb25JbjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBzZXRSZWNlaXZlRm9jdXNGcm9tQXR0cih0aGlzLl9pZHMuY29tcCk7CgogICAgICAgICAgICAgICAgdGhpcy5fZmlyc3RMYXN0Rm9jdXNhYmxlcy5maXJzdCA9IG51bGw7CiAgICAgICAgICAgICAgICB0aGlzLl9maXJzdExhc3RGb2N1c2FibGVzLmxhc3QgPSBudWxsOwoKICAgICAgICAgICAgICAgIHRoaXMuaXNWaXNpYmxlID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLiRlbCwgdGhpcy5fd2luZG93U3R5bGUpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0UG9zaXRpb24oKTsKICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmZvY3VzKCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVSZXNpemVPYnNlcnZlcigpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgdGhpcy5zdGFydEhpZGVBZnRlclRpbWVvdXQoKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGhpZGUoX2FuaW1hdGlvbk91dCwgX2J5T3ZlcmxheSkgewogICAgICAgICAgICBpZiAodGhpcy5pc1Zpc2libGUpIHsKICAgICAgICAgICAgICAgIGlmICghX2J5T3ZlcmxheSkgewogICAgICAgICAgICAgICAgICAgIGlmIChfYW5pbWF0aW9uT3V0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZEFuaW1hdGlvbk91dCA9IF9hbmltYXRpb25PdXQ7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kQW5pbWF0aW9uT3V0ID0gdGhpcy5hbmltYXRpb25PdXQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICh0aGlzLmRXaXRoT3ZlcmxheSAmJiAhX2J5T3ZlcmxheSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMub3ZlcmxheS5oaWRlKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZGVzdHJveVJlc2l6ZU9ic2VydmVyKCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1Zpc2libGUgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnd2luZG93LWhpZGUnKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm5Gb2N1cyh0aGlzLl9pZHMuY29tcCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICB0b2dnbGUoKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5pc1Zpc2libGUpIHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvdygpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBGb2N1cyBlbGVtZW50IHdpdGggYGRhdGEtZm9jdXNgIGF0dHJpYnV0ZSBvciBmb2N1cyBgLmRvY2AgYnkgZGVmYXVsdC4KICAgICAgICAgKi8KICAgICAgICBmb2N1cygpIHsKICAgICAgICAgICAgY29uc3QgZm9jdXNFbGVtID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignW2RhdGEtZm9jdXNdJyk7CiAgICAgICAgICAgIGxldCBpbnB1dEVsZW0gPSBudWxsOwoKICAgICAgICAgICAgaWYgKGZvY3VzRWxlbSkgewogICAgICAgICAgICAgICAgLy8gdHJ5IHRvIGZpbmQgZWxlbWVudCB3aXRoIGBuYW1lYCBhdHRyaWJ1dGUKICAgICAgICAgICAgICAgIGlucHV0RWxlbSA9IGZvY3VzRWxlbS5xdWVyeVNlbGVjdG9yKCdbbmFtZV0nKTsKICAgICAgICAgICAgICAgIGlmIChpbnB1dEVsZW0pIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dEVsZW0uZm9jdXMoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZm9jdXNFbGVtLmZvY3VzKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5kb2MuZm9jdXMoKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgc2V0UG9zaXRpb24oKSB7CiAgICAgICAgICAgIGNvbnN0IHN0eWxlID0ge307CgogICAgICAgICAgICBpZiAodGhpcy5pc1Zpc2libGUpIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmRQb3NpdGlvbiA9PT0gJ2ZpeGVkJykgewogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNlbnRlckhvcml6b250YWxseSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRIYWxmTWFyZ2luKHN0eWxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUubGVmdCA9ICc1MCUnOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2VudGVyVmVydGljYWxseSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRIYWxmTWFyZ2luKHN0eWxlLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUudG9wID0gJzUwJSc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVN0eWxlKHN0eWxlKTsKCiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3JyZWN0UG9zaXRpb25BbmRTaXplKCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAvLyBkZWZlcigoKSA9PiB0aGlzLmNvcnJlY3RQb3NpdGlvbkFuZFNpemUoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBjb3JyZWN0UG9zaXRpb25BbmRTaXplKCkgewogICAgICAgICAgICBsZXQgcmVjdDsKICAgICAgICAgICAgLy8gbGV0IGF0dGFjaE1hcmdpbjsKICAgICAgICAgICAgLy8gbGV0IHBvczsKICAgICAgICAgICAgY29uc3QgY3NzID0ge307CiAgICAgICAgICAgIGNvbnN0IHdpbmRvd1N0eWxlID0gdGhpcy5fd2luZG93U3R5bGU7CgogICAgICAgICAgICBpZiAoIXRoaXMuaXNWaXNpYmxlKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmRQb3NpdGlvbiA9PT0gJ2ZpeGVkJykgewogICAgICAgICAgICAgICAgcmVjdCA9IHRoaXMuJGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwoKICAgICAgICAgICAgICAgIGlmICh0aGlzLmNlbnRlckhvcml6b250YWxseSkgewogICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3dTdHlsZS5faG9ySGFsZk1hcmdpblNldCAmJiByZWN0LmxlZnQgPCAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNzcy5tYXJnaW5MZWZ0ID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgY3NzLmxlZnQgPSAwOwoKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93U3R5bGUuX2hvckhhbGZNYXJnaW5TZXQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCF3aW5kb3dTdHlsZS5faG9ySGFsZk1hcmdpblNldCAmJiByZWN0LndpZHRoIDwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldEhhbGZNYXJnaW4oY3NzKTsKICAgICAgICAgICAgICAgICAgICAgICAgY3NzLmxlZnQgPSAnNTAlJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRoaXMuY2VudGVyVmVydGljYWxseSkgewogICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3dTdHlsZS5fdmVySGFsZk1hcmdpblNldCAmJiByZWN0LnRvcCA8PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNzcy5tYXJnaW5Ub3AgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICBjc3MudG9wID0gMDsKCiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvd1N0eWxlLl92ZXJIYWxmTWFyZ2luU2V0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghd2luZG93U3R5bGUuX3ZlckhhbGZNYXJnaW5TZXQgJiYgcmVjdC5oZWlnaHQgPCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldEhhbGZNYXJnaW4oY3NzLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgY3NzLnRvcCA9ICc1MCUnOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKHJlY3QudG9wID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRIYWxmTWFyZ2luKGNzcywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVN0eWxlKGNzcyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5kUG9zaXRpb24gPT09ICdhYnNvbHV0ZScpIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmF0dGFjaFRvIHx8IHRoaXMuYXR0YWNoVG9Qb2ludCkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dGFjaE1hcmdpbiA9IHRoaXMuYXR0YWNoTWFyZ2luOwoKICAgICAgICAgICAgICAgICAgICByZWN0ID0gYXR0YWNoRWxlbVRvKAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbCwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hdHRhY2hUb1BvaW50IHx8IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5hdHRhY2hUbyksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2dldEFsaWdubWVudCgpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXlJblZpZXdwb3J0LAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IGF0dGFjaE1hcmdpblswXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiBhdHRhY2hNYXJnaW5bMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3R0b206IGF0dGFjaE1hcmdpblsyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IGF0dGFjaE1hcmdpblszXSwKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuYXR0YWNoVG9Qb2ludCA9IG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBjcmVhdGVSZXNpemVPYnNlcnZlcigpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLl9yZXNpemVPYnNlcnZlcikgewogICAgICAgICAgICAgICAgdGhpcy5fcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIodGhyb3R0bGUoKF9lbnRyaWVzKSA9PiB0aGlzLm9uUmVzaXplKF9lbnRyaWVzKSwgMzAwLCB0cnVlKSk7CiAgICAgICAgICAgICAgICB0aGlzLl9yZXNpemVPYnNlcnZlci5vYnNlcnZlKHRoaXMuJGVsKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGRlc3Ryb3lSZXNpemVPYnNlcnZlcigpIHsKICAgICAgICAgICAgaWYgKHRoaXMuX3Jlc2l6ZU9ic2VydmVyKSB7CiAgICAgICAgICAgICAgICB0aGlzLl9yZXNpemVPYnNlcnZlci5kaXNjb25uZWN0KCk7CiAgICAgICAgICAgICAgICB0aGlzLl9yZXNpemVPYnNlcnZlciA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBzdGFydEhpZGVBZnRlclRpbWVvdXQoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmhpZGVBZnRlciA+IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJIaWRlQWZ0ZXJUaW1lb3V0KCk7CgogICAgICAgICAgICAgICAgdGhpcy5faGlkZUFmdGVySWQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGUoKTsKICAgICAgICAgICAgICAgIH0sIHRoaXMuaGlkZUFmdGVyKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGNsZWFySGlkZUFmdGVyVGltZW91dCgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuX2hpZGVBZnRlcklkID4gLTEpIHsKICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9oaWRlQWZ0ZXJJZCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBfc2V0SGFsZk1hcmdpbihfc3R5bGUsIF9zZXRUb3BNYXJnaW4pIHsKICAgICAgICAgICAgY29uc3QgbWFyZ2luID0gdGhpcy5fZ2V0SGFsZk1hcmdpbihfc2V0VG9wTWFyZ2luKTsKICAgICAgICAgICAgY29uc3Qgd2luZG93U3R5bGUgPSB0aGlzLl93aW5kb3dTdHlsZTsKICAgICAgICAgICAgbGV0IHN0eWxlOwoKICAgICAgICAgICAgaWYgKG1hcmdpbikgewogICAgICAgICAgICAgICAgc3R5bGUgPSBfc3R5bGUgfHwgdGhpcy4kZWwuc3R5bGU7CgogICAgICAgICAgICAgICAgaWYgKF9zZXRUb3BNYXJnaW4pIHsKICAgICAgICAgICAgICAgICAgICBzdHlsZS5tYXJnaW5Ub3AgPSBtYXJnaW47CiAgICAgICAgICAgICAgICAgICAgd2luZG93U3R5bGUuX3ZlckhhbGZNYXJnaW5TZXQgPSB0cnVlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzdHlsZS5tYXJnaW5MZWZ0ID0gbWFyZ2luOwogICAgICAgICAgICAgICAgICAgIHdpbmRvd1N0eWxlLl9ob3JIYWxmTWFyZ2luU2V0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIF9nZXRIYWxmTWFyZ2luKF9nZXRUb3BNYXJnaW4pIHsKICAgICAgICAgICAgY29uc3Qgd2luZG93U3R5bGUgPSB0aGlzLl93aW5kb3dTdHlsZTsKICAgICAgICAgICAgY29uc3QgeyBjbGllbnRIZWlnaHQgfSA9IHRoaXMuJGVsOwoKICAgICAgICAgICAgaWYgKHdpbmRvd1N0eWxlLmhlaWdodCA9PT0gJ2F1dG8nKSB7CiAgICAgICAgICAgICAgICB3aW5kb3dTdHlsZS5oZWlnaHQgPSBgJHtjbGllbnRIZWlnaHR9cHhgOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCBsYXUgPSBnZXRMZW5ndGhBbmRVbml0KAogICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLW5lc3RlZC10ZXJuYXJ5CiAgICAgICAgICAgICAgICBfZ2V0VG9wTWFyZ2luCiAgICAgICAgICAgICAgICAgICAgPyBwYXJzZUludCh3aW5kb3dTdHlsZS5oZWlnaHQsIDEwKQogICAgICAgICAgICAgICAgICAgICAgICA/IGAke2NsaWVudEhlaWdodH1weGAKICAgICAgICAgICAgICAgICAgICAgICAgOiB3aW5kb3dTdHlsZS5tYXhIZWlnaHQKICAgICAgICAgICAgICAgICAgICA6IHBhcnNlSW50KHdpbmRvd1N0eWxlLm1heFdpZHRoLCAxMCkKICAgICAgICAgICAgICAgICAgICA/IHdpbmRvd1N0eWxlLm1heFdpZHRoCiAgICAgICAgICAgICAgICAgICAgOiB3aW5kb3dTdHlsZS53aWR0aAogICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKGxhdS5sZW4pIHsKICAgICAgICAgICAgICAgIHJldHVybiAtKGxhdS5sZW4gLyAyKSArIGxhdS51bml0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9LAoKICAgICAgICBfdXBkYXRlU3R5bGUoX2NzcykgewogICAgICAgICAgICB0aGlzLnN0eWxlID0gewogICAgICAgICAgICAgICAgLi4udGhpcy5zdHlsZSwKICAgICAgICAgICAgICAgIC4uLl9jc3MsCiAgICAgICAgICAgIH07CiAgICAgICAgfSwKCiAgICAgICAgX2dldEFsaWdubWVudCgpIHsKICAgICAgICAgICAgbGV0IGFsaWdubWVudCA9IFsnbHQnLCAnbGInXTsKICAgICAgICAgICAgbGV0IHsgYXR0YWNoUG9zaXRpb24gfSA9IHRoaXM7CiAgICAgICAgICAgIGxldCBwb3M7CgogICAgICAgICAgICBpZiAoYXR0YWNoUG9zaXRpb24pIHsKICAgICAgICAgICAgICAgIGlmIChhdHRhY2hQb3NpdGlvbi5pbmRleE9mKCdhdXRvJykgPiAtMSkgewogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmF0dGFjaFRvUG9pbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gZ2V0QXR0YWNoUG9zaXRpb25CeVJlY3RzKGdldEVsZW1SZWN0KHRoaXMuJGVsKSwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiB0aGlzLmF0dGFjaFRvUG9pbnRbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHRoaXMuYXR0YWNoVG9Qb2ludFsxXSwKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmF0dGFjaFRvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IGdldEF0dGFjaFBvc2l0aW9uKHRoaXMuJGVsLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuYXR0YWNoVG8pKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGF0dGFjaFBvc2l0aW9uID0gZ2V0QXV0b0F0dGFjaFBvc2l0aW9uKHBvcywgYXR0YWNoUG9zaXRpb24sIHRoaXMucHJlZmVycmVkQXR0YWNoUG9zaXRpb24pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGFsaWdubWVudCA9IGdldEFsaWdubWVudChhdHRhY2hQb3NpdGlvbik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBhbGlnbm1lbnQ7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn0KICAgICAgICAgKi8KICAgICAgICBpc0NoaWxkV2luZG93T3BlbmVkKCkgewogICAgICAgICAgICBjb25zdCBvcGVuZWRXaW5kb3cgPSB0aGlzLmZpbmRDaGlsZEJ5TmFtZSgnZi13aW5kb3cnLCBmYWxzZSwgKF9jb21wb25lbnQpID0+IF9jb21wb25lbnQuaXNWaXNpYmxlKTsKCiAgICAgICAgICAgIHJldHVybiAhIW9wZW5lZFdpbmRvdzsKICAgICAgICB9LAoKICAgICAgICBvbldpbmRvd1Jlc2l6ZSgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuaXNWaXNpYmxlKSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5oaWRlT25XaW5kb3dSZXNpemUpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGUoKTsKICAgICAgICAgICAgICAgIH0gLyogZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3JyZWN0UG9zaXRpb25BbmRTaXplKCk7CiAgICAgICAgICAgICAgICB9Ki8KICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIEBwYXJhbSB7TW91c2VFdmVudH0gX2V2ZW50CiAgICAgICAgICovCiAgICAgICAgb25XaW5kb3dNb3VzZWRvd24oX2V2ZW50KSB7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgIHRoaXMuaXNWaXNpYmxlICYmCiAgICAgICAgICAgICAgICB0aGlzLmhpZGVPbldpbmRvd01vdXNlZG93biAmJgogICAgICAgICAgICAgICAgIV9ldmVudC50YXJnZXQuY2xvc2VzdChgIyR7dGhpcy5pZH1gKSAmJgogICAgICAgICAgICAgICAgIXRoaXMuaXNDaGlsZFdpbmRvd09wZW5lZCgpCiAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBDYWxsZWQgYnkgUmVzaXplT2JzZXJ2ZXIgd2hlbiBGV2luZG93IGlzIHJlc2l6ZWQuCiAgICAgICAgICovCiAgICAgICAgb25SZXNpemUoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmlzVmlzaWJsZSkgewogICAgICAgICAgICAgICAgdGhpcy5jb3JyZWN0UG9zaXRpb25BbmRTaXplKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBvbk92ZXJsYXlIaWRlKF9oaWRkZW5CeUNsaWNrKSB7CiAgICAgICAgICAgIHRoaXMuaGlkZSgnJywgdHJ1ZSwgX2hpZGRlbkJ5Q2xpY2spOwogICAgICAgIH0sCgogICAgICAgIG9uQ29udHJvbHNDbGljayhfZXZlbnQpIHsKICAgICAgICAgICAgaWYgKF9ldmVudC50YXJnZXQuY2xvc2VzdCgnLmNsb3NlLWJ0bicpKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhpZGUoKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIG9uS2V5dXAoX2V2ZW50KSB7CiAgICAgICAgICAgIGlmICh0aGlzLmhpZGVPbkVzY2FwZUtleSkgewogICAgICAgICAgICAgICAgaWYgKGlzS2V5KCdFc2NhcGUnLCBfZXZlbnQpKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBvbktleWRvd24oX2V2ZW50KSB7CiAgICAgICAgICAgIGZvY3VzVHJhcChfZXZlbnQsIHRoaXMuJGVsLCB0aGlzLl9maXJzdExhc3RGb2N1c2FibGVzKTsKICAgICAgICB9LAogICAgfSwKfTsK"},{"version":3,"sources":["FWindow.vue"],"names":[],"mappings":";AAuDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"FWindow.vue","sourceRoot":"src/components/core/FWindow","sourcesContent":["<template>\n    <transition :enter-active-class=\"dAnimationIn\" :leave-active-class=\"dAnimationOut\">\n        <div\n            v-if=\"isVisible\"\n            :id=\"id\"\n            class=\"f-window\"\n            :class=\"cssClass\"\n            :style=\"style\"\n            :role=\"role\"\n            :aria-modal=\"modal\"\n            :aria-labelledby=\"_ids.title\"\n            :aria-describedby=\"_ids.body\"\n            @keyup=\"onKeyup\"\n            @keydown=\"onKeydown\"\n        >\n            <div ref=\"doc\" role=\"document\" tabindex=\"-1\" class=\"doc\">\n                <header v-if=\"withHeader\">\n                    <div :id=\"_ids.title\" class=\"title\">\n                        <!-- @slot Default to `title` prop -->\n                        <slot name=\"title\">\n                            <h2>{{ title }}</h2>\n                        </slot>\n                    </div>\n                    <div class=\"controls\" @click=\"onControlsClick\">\n                        <!-- @slot Default to `close-btn` button -->\n                        <slot name=\"controls\">\n                            <button class=\"btn close-btn same-size round light\" title=\"Close window\">\n                                <icon data=\"@/assets/svg/times.svg\" width=\"20\" height=\"20\" />\n                            </button>\n                        </slot>\n                    </div>\n                </header>\n\n                <div :id=\"_ids.body\" class=\"body\">\n                    <slot></slot>\n                </div>\n\n                <footer v-if=\"withFooter\">\n                    <slot name=\"footer\"></slot>\n                </footer>\n\n                <f-overlay\n                    v-if=\"dWithOverlay && isVisible\"\n                    ref=\"overlay\"\n                    :z-index=\"dZIndex - 1\"\n                    class=\"f-window-overlay\"\n                    :hide-on-click=\"hideOnEscapeKey\"\n                    @overlay-hide=\"onOverlayHide\"\n                />\n            </div>\n        </div>\n    </transition>\n</template>\n\n<script>\nimport { getLengthAndUnit, getComputedStyle } from '../../../utils/css.js';\nimport { getUniqueId, throttle } from '../../../utils/index.js';\nimport FOverlay from '../FOverlay/FOverlay.vue';\nimport { focusTrap, isKey, returnFocus, setReceiveFocusFromAttr } from '../../../utils/aria.js';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport { helpersMixin } from '../../../mixins/helpers.js';\nimport {\n    attachElemTo,\n    getAlignment,\n    getAttachPosition,\n    getAttachPositionByRects,\n    getAutoAttachPosition,\n    getElemRect,\n} from '../../../utils/DOM.js';\n\n/**\n * Basic window following WAI-ARIA practices.\n * Needs `resize-observer-polyfill` plugin.\n */\nexport default {\n    name: 'FWindow',\n\n    components: { FOverlay },\n\n    mixins: [helpersMixin],\n\n    props: {\n        /** Is window visible on initialization? */\n        visible: {\n            type: Boolean,\n            default: false,\n        },\n        /** Title of window rendered in header. */\n        title: {\n            type: String,\n            default: '',\n        },\n        /** Has window a title? */\n        noTitle: {\n            type: Boolean,\n            default: false,\n        },\n        /** Animation that starts when the window is just about to show. */\n        animationIn: {\n            type: String,\n            default: 'fade-enter-active',\n        },\n        /** Animation that starts when the window is just about to hide. */\n        animationOut: {\n            type: String,\n            default: 'fade-leave-active',\n        },\n        /** WAI-ARIA role. */\n        role: {\n            type: String,\n            default: 'dialog',\n        },\n        /** Is window a modal? */\n        modal: {\n            type: Boolean,\n            default: false,\n        },\n        /** Is window a popover? */\n        popover: {\n            type: Boolean,\n            default: false,\n        },\n        /** `<header>` will be rendered. */\n        withHeader: {\n            type: Boolean,\n            default: true,\n        },\n        /** `<footer>` will be rendered. */\n        withFooter: {\n            type: Boolean,\n            default: false,\n        },\n        /** `FOverlay` shows. */\n        withOverlay: {\n            type: Boolean,\n            default: true,\n        },\n        /** 'fixed' | 'absolute' */\n        position: {\n            type: String,\n            default: 'fixed',\n        },\n        /** `z-index` of window, if overlay is used, it has `z-index` `zIndex -1`. */\n        zIndex: {\n            type: Number,\n            default: 10,\n        },\n        /** CSS selector. If window is popover, it will be attached to elemnet given by this selector. */\n        attachTo: {\n            type: String,\n            default: '',\n        },\n        /**\n         * How to place popover to `attachTo` element. (`'top'`, `'right'`, `'bottom'`, `'left'`, `'auto'`, `'[lcrm][tcbm] [lcrm][tcbm]'`)\n         *\n         * @type {('top', 'right', 'bottom', 'left', 'auto', '[lcrm][tcbm] [lcrm][tcbm]')}\n         */\n        attachPosition: {\n            type: String,\n            default: '',\n        },\n        /**\n         * Prefered attach position, if `attachPosition` is `'auto'`. (`'top'`, `'right'`, `'bottom'`, `'left'`, `'auto'`, `'[lcrm][tcbm] [lcrm][tcbm]'`)\n         *\n         * @type {('top', 'right', 'bottom', 'left', 'auto', '[lcrm][tcbm] [lcrm][tcbm]')}\n         */\n        preferredAttachPosition: {\n            type: String,\n            default: '',\n        },\n        /**\n         * Margin of popover. (`[top, right, bottom, left]`)\n         *\n         * @type {[number, number, number, number]}\n         */\n        attachMargin: {\n            type: Array,\n            default() {\n                return [0, 0, 0, 0];\n            },\n            validator: function (_value) {\n                return _value.length === 4;\n            },\n        },\n        /** Hide window after this amout of milliseconds. 0 means no auto hiding. */\n        hideAfter: {\n            type: Number,\n            default: 0,\n        },\n        /** Center window horizontally. */\n        centerHorizontally: {\n            type: Boolean,\n            default: true,\n        },\n        /** Center window vertically. */\n        centerVertically: {\n            type: Boolean,\n            default: true,\n        },\n        /** Make window stay in viewport. */\n        stayInViewport: {\n            type: Boolean,\n            default: true,\n        },\n        /** Hide window when browser window is resized. */\n        hideOnWindowResize: {\n            type: Boolean,\n            default: false,\n        },\n        /** Hide window on browser window mousedown. */\n        hideOnWindowMousedown: {\n            type: Boolean,\n            default: false,\n        },\n        /** Hide window when escape key is pressed. */\n        hideOnEscapeKey: {\n            type: Boolean,\n            default: true,\n        },\n    },\n\n    data() {\n        return {\n            id: getUniqueId(),\n            isVisible: false,\n            dPosition: this.popover ? 'absolute' : this.position,\n            dAnimationIn: this.animationIn,\n            dAnimationOut: this.animationOut,\n            dZIndex: this.zIndex,\n            dWithOverlay: this.popover ? false : this.withOverlay,\n            style: {\n                zIndex: this.zIndex,\n            },\n        };\n    },\n\n    computed: {\n        cssClass() {\n            return {\n                'pos-absolute': this.dPosition === 'absolute',\n                'pos-fixed': this.dPosition === 'fixed',\n                'with-header': this.withHeader,\n                'with-footer': this.withFooter,\n                'no-title': this.noTitle,\n                modal: this.modal,\n                popover: this.popover,\n            };\n        },\n    },\n\n    watch: {\n        visible(_value) {\n            this.isVisible = _value;\n        },\n    },\n\n    created() {\n        /** Initial css values of window. */\n        this._windowStyle = {\n            top: 0,\n            left: 0,\n            width: 0,\n            maxWidth: 0,\n            minWidth: 0,\n            height: 0,\n            maxHeight: 0,\n            minHeight: 0,\n            /*\n            borderTopLeftRadius: 0,\n            borderTopRightRadius: 0,\n            borderBottomLeftRadius: 0,\n            borderBottomRightRadius: 0,\n            */\n            _horHalfMarginSet: false, // helper\n            _verHalfMarginSet: false, // helper\n        };\n        /** Various ids. */\n        this._ids = {\n            comp: `fwin-${this._uid}`,\n            title: `fwin-title-${this._uid}`,\n            body: `fwin-body-${this._uid}`,\n        };\n        /** Debounce function used as window resize callback. */\n        this._resizeCallback = throttle((_event) => this.onWindowResize(_event), 300, true);\n        /** Instance of ResizeObserver. */\n        this._resizeObserver = null;\n        /** Stores first and last focusable elements in window. */\n        this._firstLastFocusables = {\n            first: null,\n            last: null,\n        };\n        /** `hideAfter` timeout id. */\n        this._hideAfterId = -1;\n    },\n\n    mounted() {\n        document.body.appendChild(this.$el);\n\n        if (this.hideOnWindowResize) {\n            window.addEventListener('resize', this._resizeCallback, false);\n        }\n\n        if (this.hideOnWindowMousedown) {\n            window.addEventListener('mousedown', this.onWindowMousedown, false);\n        }\n\n        if (this.visible) {\n            this.$nextTick(() => {\n                this.show();\n            });\n        }\n    },\n\n    beforeDestroy() {\n        this._firstLastFocusables = null;\n\n        if (this.hideOnWindowResize) {\n            window.removeEventListener('resize', this._resizeCallback);\n        }\n\n        if (this.hideOnWindowMousedown) {\n            window.removeEventListener('mousedown', this.onWindowMousedown);\n        }\n\n        this.clearHideAfterTimeout();\n\n        this.destroyResizeObserver();\n    },\n\n    destroyed() {\n        this.$el.remove();\n    },\n\n    methods: {\n        show(_animationIn) {\n            if (!this.isVisible) {\n                const parentWindow = this.findParentByName('f-window');\n\n                if (parentWindow) {\n                    this.dZIndex = parentWindow.dZIndex + 2;\n                    this._updateStyle({ zIndex: this.dZIndex });\n                }\n\n                if (_animationIn) {\n                    this.dAnimationIn = _animationIn;\n                } else {\n                    this.dAnimationIn = this.animationIn;\n                }\n\n                setReceiveFocusFromAttr(this._ids.comp);\n\n                this._firstLastFocusables.first = null;\n                this._firstLastFocusables.last = null;\n\n                this.isVisible = true;\n\n                this.$nextTick(() => {\n                    getComputedStyle(this.$el, this._windowStyle);\n                    this.setPosition();\n                    // this.focus();\n                    this.createResizeObserver();\n                });\n\n                this.startHideAfterTimeout();\n            }\n        },\n\n        hide(_animationOut, _byOverlay) {\n            if (this.isVisible) {\n                if (!_byOverlay) {\n                    if (_animationOut) {\n                        this.dAnimationOut = _animationOut;\n                    } else {\n                        this.dAnimationOut = this.animationOut;\n                    }\n                }\n\n                if (this.dWithOverlay && !_byOverlay) {\n                    this.$refs.overlay.hide();\n                } else {\n                    this.destroyResizeObserver();\n                    this.isVisible = false;\n\n                    this.$emit('window-hide');\n                }\n\n                returnFocus(this._ids.comp);\n            }\n        },\n\n        toggle() {\n            if (!this.isVisible) {\n                this.show();\n            } else {\n                this.hide();\n            }\n        },\n\n        /**\n         * Focus element with `data-focus` attribute or focus `.doc` by default.\n         */\n        focus() {\n            const focusElem = this.$el.querySelector('[data-focus]');\n            let inputElem = null;\n\n            if (focusElem) {\n                // try to find element with `name` attribute\n                inputElem = focusElem.querySelector('[name]');\n                if (inputElem) {\n                    inputElem.focus();\n                } else {\n                    focusElem.focus();\n                }\n            } else {\n                this.$nextTick(() => {\n                    this.$refs.doc.focus();\n                });\n            }\n        },\n\n        setPosition() {\n            const style = {};\n\n            if (this.isVisible) {\n                if (this.dPosition === 'fixed') {\n                    if (this.centerHorizontally) {\n                        this._setHalfMargin(style);\n                        style.left = '50%';\n                    }\n\n                    if (this.centerVertically) {\n                        this._setHalfMargin(style, true);\n                        style.top = '50%';\n                    }\n                }\n\n                this._updateStyle(style);\n\n                this.$nextTick(() => {\n                    this.correctPositionAndSize();\n                });\n\n                // defer(() => this.correctPositionAndSize());\n            }\n        },\n\n        correctPositionAndSize() {\n            let rect;\n            // let attachMargin;\n            // let pos;\n            const css = {};\n            const windowStyle = this._windowStyle;\n\n            if (!this.isVisible) {\n                return;\n            }\n\n            if (this.dPosition === 'fixed') {\n                rect = this.$el.getBoundingClientRect();\n\n                if (this.centerHorizontally) {\n                    if (windowStyle._horHalfMarginSet && rect.left < 0) {\n                        css.marginLeft = 0;\n                        css.left = 0;\n\n                        windowStyle._horHalfMarginSet = false;\n                    } else if (!windowStyle._horHalfMarginSet && rect.width < document.documentElement.clientWidth) {\n                        this._setHalfMargin(css);\n                        css.left = '50%';\n                    }\n                }\n\n                if (this.centerVertically) {\n                    if (windowStyle._verHalfMarginSet && rect.top <= 0) {\n                        css.marginTop = 0;\n                        css.top = 0;\n\n                        windowStyle._verHalfMarginSet = false;\n                    } else if (!windowStyle._verHalfMarginSet && rect.height < document.documentElement.clientHeight) {\n                        this._setHalfMargin(css, true);\n                        css.top = '50%';\n                    }\n\n                    if (rect.top > 0) {\n                        this._setHalfMargin(css, true);\n                    }\n                }\n\n                this._updateStyle(css);\n            } else if (this.dPosition === 'absolute') {\n                if (this.attachTo || this.attachToPoint) {\n                    const attachMargin = this.attachMargin;\n\n                    rect = attachElemTo(\n                        this.$el,\n                        this.attachToPoint || document.querySelector(this.attachTo),\n                        this._getAlignment(),\n                        this.stayInViewport,\n                        {\n                            top: attachMargin[0],\n                            right: attachMargin[1],\n                            bottom: attachMargin[2],\n                            left: attachMargin[3],\n                        }\n                    );\n\n                    this.attachToPoint = null;\n                }\n            }\n        },\n\n        createResizeObserver() {\n            if (!this._resizeObserver) {\n                this._resizeObserver = new ResizeObserver(throttle((_entries) => this.onResize(_entries), 300, true));\n                this._resizeObserver.observe(this.$el);\n            }\n        },\n\n        destroyResizeObserver() {\n            if (this._resizeObserver) {\n                this._resizeObserver.disconnect();\n                this._resizeObserver = null;\n            }\n        },\n\n        startHideAfterTimeout() {\n            if (this.hideAfter > 0) {\n                this.clearHideAfterTimeout();\n\n                this._hideAfterId = setTimeout(() => {\n                    this.hide();\n                }, this.hideAfter);\n            }\n        },\n\n        clearHideAfterTimeout() {\n            if (this._hideAfterId > -1) {\n                clearTimeout(this._hideAfterId);\n            }\n        },\n\n        _setHalfMargin(_style, _setTopMargin) {\n            const margin = this._getHalfMargin(_setTopMargin);\n            const windowStyle = this._windowStyle;\n            let style;\n\n            if (margin) {\n                style = _style || this.$el.style;\n\n                if (_setTopMargin) {\n                    style.marginTop = margin;\n                    windowStyle._verHalfMarginSet = true;\n                } else {\n                    style.marginLeft = margin;\n                    windowStyle._horHalfMarginSet = true;\n                }\n            }\n        },\n\n        _getHalfMargin(_getTopMargin) {\n            const windowStyle = this._windowStyle;\n            const { clientHeight } = this.$el;\n\n            if (windowStyle.height === 'auto') {\n                windowStyle.height = `${clientHeight}px`;\n            }\n\n            const lau = getLengthAndUnit(\n                // eslint-disable-next-line no-nested-ternary\n                _getTopMargin\n                    ? parseInt(windowStyle.height, 10)\n                        ? `${clientHeight}px`\n                        : windowStyle.maxHeight\n                    : parseInt(windowStyle.maxWidth, 10)\n                    ? windowStyle.maxWidth\n                    : windowStyle.width\n            );\n\n            if (lau.len) {\n                return -(lau.len / 2) + lau.unit;\n            }\n            return '';\n        },\n\n        _updateStyle(_css) {\n            this.style = {\n                ...this.style,\n                ..._css,\n            };\n        },\n\n        _getAlignment() {\n            let alignment = ['lt', 'lb'];\n            let { attachPosition } = this;\n            let pos;\n\n            if (attachPosition) {\n                if (attachPosition.indexOf('auto') > -1) {\n                    if (this.attachToPoint) {\n                        pos = getAttachPositionByRects(getElemRect(this.$el), {\n                            width: 1,\n                            height: 1,\n                            left: this.attachToPoint[0],\n                            top: this.attachToPoint[1],\n                        });\n                    } else if (this.attachTo) {\n                        pos = getAttachPosition(this.$el, document.querySelector(this.attachTo));\n                    }\n\n                    attachPosition = getAutoAttachPosition(pos, attachPosition, this.preferredAttachPosition);\n                }\n\n                alignment = getAlignment(attachPosition);\n            }\n\n            return alignment;\n        },\n\n        /**\n         * @return {boolean}\n         */\n        isChildWindowOpened() {\n            const openedWindow = this.findChildByName('f-window', false, (_component) => _component.isVisible);\n\n            return !!openedWindow;\n        },\n\n        onWindowResize() {\n            if (this.isVisible) {\n                if (this.hideOnWindowResize) {\n                    this.hide();\n                } /* else {\n                    this.correctPositionAndSize();\n                }*/\n            }\n        },\n\n        /**\n         * @param {MouseEvent} _event\n         */\n        onWindowMousedown(_event) {\n            if (\n                this.isVisible &&\n                this.hideOnWindowMousedown &&\n                !_event.target.closest(`#${this.id}`) &&\n                !this.isChildWindowOpened()\n            ) {\n                this.hide();\n            }\n        },\n\n        /**\n         * Called by ResizeObserver when FWindow is resized.\n         */\n        onResize() {\n            if (this.isVisible) {\n                this.correctPositionAndSize();\n            }\n        },\n\n        onOverlayHide(_hiddenByClick) {\n            this.hide('', true, _hiddenByClick);\n        },\n\n        onControlsClick(_event) {\n            if (_event.target.closest('.close-btn')) {\n                this.hide();\n            }\n        },\n\n        onKeyup(_event) {\n            if (this.hideOnEscapeKey) {\n                if (isKey('Escape', _event)) {\n                    this.hide();\n                }\n            }\n        },\n\n        onKeydown(_event) {\n            focusTrap(_event, this.$el, this._firstLastFocusables);\n        },\n    },\n};\n</script>\n\n<style lang=\"scss\">\n@import 'style';\n</style>\n"]}]}