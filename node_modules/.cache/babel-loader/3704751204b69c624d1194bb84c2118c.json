{"remainingRequest":"/mnt/websites/ex.nextsmartchain.com/node_modules/thread-loader/dist/cjs.js!/mnt/websites/ex.nextsmartchain.com/node_modules/babel-loader/lib/index.js!/mnt/websites/ex.nextsmartchain.com/node_modules/cache-loader/dist/cjs.js??ref--1-0!/mnt/websites/ex.nextsmartchain.com/node_modules/vue-loader/lib/index.js??vue-loader-options!/mnt/websites/ex.nextsmartchain.com/src/components/core/FWindow/FWindow.vue?vue&type=script&lang=js&","dependencies":[{"path":"/mnt/websites/ex.nextsmartchain.com/src/components/core/FWindow/FWindow.vue","mtime":1657708591926},{"path":"/mnt/websites/ex.nextsmartchain.com/babel.config.js","mtime":1657708595230},{"path":"/mnt/websites/ex.nextsmartchain.com/node_modules/cache-loader/dist/cjs.js","mtime":1655491106804},{"path":"/mnt/websites/ex.nextsmartchain.com/node_modules/thread-loader/dist/cjs.js","mtime":1655491285854},{"path":"/mnt/websites/ex.nextsmartchain.com/node_modules/babel-loader/lib/index.js","mtime":1655491285588},{"path":"/mnt/websites/ex.nextsmartchain.com/node_modules/cache-loader/dist/cjs.js","mtime":1655491106804},{"path":"/mnt/websites/ex.nextsmartchain.com/node_modules/vue-loader/lib/index.js","mtime":1657708714280}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL21udC93ZWJzaXRlcy9leC5uZXh0c21hcnRjaGFpbi5jb20vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IuanMiOwppbXBvcnQgeyBnZXRMZW5ndGhBbmRVbml0LCBnZXRDb21wdXRlZFN0eWxlIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvY3NzLmpzJzsKaW1wb3J0IHsgZ2V0VW5pcXVlSWQsIHRocm90dGxlIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvaW5kZXguanMnOwppbXBvcnQgRk92ZXJsYXkgZnJvbSAnLi4vRk92ZXJsYXkvRk92ZXJsYXkudnVlJzsKaW1wb3J0IHsgZm9jdXNUcmFwLCBpc0tleSwgcmV0dXJuRm9jdXMsIHNldFJlY2VpdmVGb2N1c0Zyb21BdHRyIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvYXJpYS5qcyc7CmltcG9ydCBSZXNpemVPYnNlcnZlciBmcm9tICdyZXNpemUtb2JzZXJ2ZXItcG9seWZpbGwnOwppbXBvcnQgeyBoZWxwZXJzTWl4aW4gfSBmcm9tICcuLi8uLi8uLi9taXhpbnMvaGVscGVycy5qcyc7CmltcG9ydCB7IGF0dGFjaEVsZW1UbywgZ2V0QWxpZ25tZW50LCBnZXRBdHRhY2hQb3NpdGlvbiwgZ2V0QXR0YWNoUG9zaXRpb25CeVJlY3RzLCBnZXRBdXRvQXR0YWNoUG9zaXRpb24sIGdldEVsZW1SZWN0IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvRE9NLmpzJzsKLyoqCiAqIEJhc2ljIHdpbmRvdyBmb2xsb3dpbmcgV0FJLUFSSUEgcHJhY3RpY2VzLgogKiBOZWVkcyBgcmVzaXplLW9ic2VydmVyLXBvbHlmaWxsYCBwbHVnaW4uCiAqLwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdGV2luZG93JywKICBjb21wb25lbnRzOiB7CiAgICBGT3ZlcmxheTogRk92ZXJsYXkKICB9LAogIG1peGluczogW2hlbHBlcnNNaXhpbl0sCiAgcHJvcHM6IHsKICAgIC8qKiBJcyB3aW5kb3cgdmlzaWJsZSBvbiBpbml0aWFsaXphdGlvbj8gKi8KICAgIHZpc2libGU6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCgogICAgLyoqIFRpdGxlIG9mIHdpbmRvdyByZW5kZXJlZCBpbiBoZWFkZXIuICovCiAgICB0aXRsZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICcnCiAgICB9LAoKICAgIC8qKiBIYXMgd2luZG93IGEgdGl0bGU/ICovCiAgICBub1RpdGxlOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAoKICAgIC8qKiBBbmltYXRpb24gdGhhdCBzdGFydHMgd2hlbiB0aGUgd2luZG93IGlzIGp1c3QgYWJvdXQgdG8gc2hvdy4gKi8KICAgIGFuaW1hdGlvbkluOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ2ZhZGUtZW50ZXItYWN0aXZlJwogICAgfSwKCiAgICAvKiogQW5pbWF0aW9uIHRoYXQgc3RhcnRzIHdoZW4gdGhlIHdpbmRvdyBpcyBqdXN0IGFib3V0IHRvIGhpZGUuICovCiAgICBhbmltYXRpb25PdXQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnZmFkZS1sZWF2ZS1hY3RpdmUnCiAgICB9LAoKICAgIC8qKiBXQUktQVJJQSByb2xlLiAqLwogICAgcm9sZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdkaWFsb2cnCiAgICB9LAoKICAgIC8qKiBJcyB3aW5kb3cgYSBtb2RhbD8gKi8KICAgIG1vZGFsOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAoKICAgIC8qKiBJcyB3aW5kb3cgYSBwb3BvdmVyPyAqLwogICAgcG9wb3ZlcjogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKCiAgICAvKiogYDxoZWFkZXI+YCB3aWxsIGJlIHJlbmRlcmVkLiAqLwogICAgd2l0aEhlYWRlcjogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAoKICAgIC8qKiBgPGZvb3Rlcj5gIHdpbGwgYmUgcmVuZGVyZWQuICovCiAgICB3aXRoRm9vdGVyOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAoKICAgIC8qKiBgRk92ZXJsYXlgIHNob3dzLiAqLwogICAgd2l0aE92ZXJsYXk6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfSwKCiAgICAvKiogJ2ZpeGVkJyB8ICdhYnNvbHV0ZScgKi8KICAgIHBvc2l0aW9uOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ2ZpeGVkJwogICAgfSwKCiAgICAvKiogYHotaW5kZXhgIG9mIHdpbmRvdywgaWYgb3ZlcmxheSBpcyB1c2VkLCBpdCBoYXMgYHotaW5kZXhgIGB6SW5kZXggLTFgLiAqLwogICAgekluZGV4OiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogMTAKICAgIH0sCgogICAgLyoqIENTUyBzZWxlY3Rvci4gSWYgd2luZG93IGlzIHBvcG92ZXIsIGl0IHdpbGwgYmUgYXR0YWNoZWQgdG8gZWxlbW5ldCBnaXZlbiBieSB0aGlzIHNlbGVjdG9yLiAqLwogICAgYXR0YWNoVG86IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnJwogICAgfSwKCiAgICAvKioKICAgICAqIEhvdyB0byBwbGFjZSBwb3BvdmVyIHRvIGBhdHRhY2hUb2AgZWxlbWVudC4gKGAndG9wJ2AsIGAncmlnaHQnYCwgYCdib3R0b20nYCwgYCdsZWZ0J2AsIGAnYXV0bydgLCBgJ1tsY3JtXVt0Y2JtXSBbbGNybV1bdGNibV0nYCkKICAgICAqCiAgICAgKiBAdHlwZSB7KCd0b3AnLCAncmlnaHQnLCAnYm90dG9tJywgJ2xlZnQnLCAnYXV0bycsICdbbGNybV1bdGNibV0gW2xjcm1dW3RjYm1dJyl9CiAgICAgKi8KICAgIGF0dGFjaFBvc2l0aW9uOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJycKICAgIH0sCgogICAgLyoqCiAgICAgKiBQcmVmZXJlZCBhdHRhY2ggcG9zaXRpb24sIGlmIGBhdHRhY2hQb3NpdGlvbmAgaXMgYCdhdXRvJ2AuIChgJ3RvcCdgLCBgJ3JpZ2h0J2AsIGAnYm90dG9tJ2AsIGAnbGVmdCdgLCBgJ2F1dG8nYCwgYCdbbGNybV1bdGNibV0gW2xjcm1dW3RjYm1dJ2ApCiAgICAgKgogICAgICogQHR5cGUgeygndG9wJywgJ3JpZ2h0JywgJ2JvdHRvbScsICdsZWZ0JywgJ2F1dG8nLCAnW2xjcm1dW3RjYm1dIFtsY3JtXVt0Y2JtXScpfQogICAgICovCiAgICBwcmVmZXJyZWRBdHRhY2hQb3NpdGlvbjogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICcnCiAgICB9LAoKICAgIC8qKgogICAgICogTWFyZ2luIG9mIHBvcG92ZXIuIChgW3RvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdF1gKQogICAgICoKICAgICAqIEB0eXBlIHtbbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyXX0KICAgICAqLwogICAgYXR0YWNoTWFyZ2luOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gWzAsIDAsIDAsIDBdOwogICAgICB9LAogICAgICB2YWxpZGF0b3I6IGZ1bmN0aW9uIHZhbGlkYXRvcihfdmFsdWUpIHsKICAgICAgICByZXR1cm4gX3ZhbHVlLmxlbmd0aCA9PT0gNDsKICAgICAgfQogICAgfSwKCiAgICAvKiogSGlkZSB3aW5kb3cgYWZ0ZXIgdGhpcyBhbW91dCBvZiBtaWxsaXNlY29uZHMuIDAgbWVhbnMgbm8gYXV0byBoaWRpbmcuICovCiAgICBoaWRlQWZ0ZXI6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAwCiAgICB9LAoKICAgIC8qKiBDZW50ZXIgd2luZG93IGhvcml6b250YWxseS4gKi8KICAgIGNlbnRlckhvcml6b250YWxseTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAoKICAgIC8qKiBDZW50ZXIgd2luZG93IHZlcnRpY2FsbHkuICovCiAgICBjZW50ZXJWZXJ0aWNhbGx5OiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCgogICAgLyoqIE1ha2Ugd2luZG93IHN0YXkgaW4gdmlld3BvcnQuICovCiAgICBzdGF5SW5WaWV3cG9ydDogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAoKICAgIC8qKiBIaWRlIHdpbmRvdyB3aGVuIGJyb3dzZXIgd2luZG93IGlzIHJlc2l6ZWQuICovCiAgICBoaWRlT25XaW5kb3dSZXNpemU6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCgogICAgLyoqIEhpZGUgd2luZG93IG9uIGJyb3dzZXIgd2luZG93IG1vdXNlZG93bi4gKi8KICAgIGhpZGVPbldpbmRvd01vdXNlZG93bjogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKCiAgICAvKiogSGlkZSB3aW5kb3cgd2hlbiBlc2NhcGUga2V5IGlzIHByZXNzZWQuICovCiAgICBoaWRlT25Fc2NhcGVLZXk6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlkOiBnZXRVbmlxdWVJZCgpLAogICAgICBpc1Zpc2libGU6IGZhbHNlLAogICAgICBkUG9zaXRpb246IHRoaXMucG9wb3ZlciA/ICdhYnNvbHV0ZScgOiB0aGlzLnBvc2l0aW9uLAogICAgICBkQW5pbWF0aW9uSW46IHRoaXMuYW5pbWF0aW9uSW4sCiAgICAgIGRBbmltYXRpb25PdXQ6IHRoaXMuYW5pbWF0aW9uT3V0LAogICAgICBkWkluZGV4OiB0aGlzLnpJbmRleCwKICAgICAgZFdpdGhPdmVybGF5OiB0aGlzLnBvcG92ZXIgPyBmYWxzZSA6IHRoaXMud2l0aE92ZXJsYXksCiAgICAgIHN0eWxlOiB7CiAgICAgICAgekluZGV4OiB0aGlzLnpJbmRleAogICAgICB9CiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGNzc0NsYXNzOiBmdW5jdGlvbiBjc3NDbGFzcygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICAncG9zLWFic29sdXRlJzogdGhpcy5kUG9zaXRpb24gPT09ICdhYnNvbHV0ZScsCiAgICAgICAgJ3Bvcy1maXhlZCc6IHRoaXMuZFBvc2l0aW9uID09PSAnZml4ZWQnLAogICAgICAgICd3aXRoLWhlYWRlcic6IHRoaXMud2l0aEhlYWRlciwKICAgICAgICAnd2l0aC1mb290ZXInOiB0aGlzLndpdGhGb290ZXIsCiAgICAgICAgJ25vLXRpdGxlJzogdGhpcy5ub1RpdGxlLAogICAgICAgIG1vZGFsOiB0aGlzLm1vZGFsLAogICAgICAgIHBvcG92ZXI6IHRoaXMucG9wb3ZlcgogICAgICB9OwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIHZpc2libGU6IGZ1bmN0aW9uIHZpc2libGUoX3ZhbHVlKSB7CiAgICAgIHRoaXMuaXNWaXNpYmxlID0gX3ZhbHVlOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgLyoqIEluaXRpYWwgY3NzIHZhbHVlcyBvZiB3aW5kb3cuICovCiAgICB0aGlzLl93aW5kb3dTdHlsZSA9IHsKICAgICAgdG9wOiAwLAogICAgICBsZWZ0OiAwLAogICAgICB3aWR0aDogMCwKICAgICAgbWF4V2lkdGg6IDAsCiAgICAgIG1pbldpZHRoOiAwLAogICAgICBoZWlnaHQ6IDAsCiAgICAgIG1heEhlaWdodDogMCwKICAgICAgbWluSGVpZ2h0OiAwLAoKICAgICAgLyoKICAgICAgYm9yZGVyVG9wTGVmdFJhZGl1czogMCwKICAgICAgYm9yZGVyVG9wUmlnaHRSYWRpdXM6IDAsCiAgICAgIGJvcmRlckJvdHRvbUxlZnRSYWRpdXM6IDAsCiAgICAgIGJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzOiAwLAogICAgICAqLwogICAgICBfaG9ySGFsZk1hcmdpblNldDogZmFsc2UsCiAgICAgIC8vIGhlbHBlcgogICAgICBfdmVySGFsZk1hcmdpblNldDogZmFsc2UgLy8gaGVscGVyCgogICAgfTsKICAgIC8qKiBWYXJpb3VzIGlkcy4gKi8KCiAgICB0aGlzLl9pZHMgPSB7CiAgICAgIGNvbXA6ICJmd2luLSIuY29uY2F0KHRoaXMuX3VpZCksCiAgICAgIHRpdGxlOiAiZndpbi10aXRsZS0iLmNvbmNhdCh0aGlzLl91aWQpLAogICAgICBib2R5OiAiZndpbi1ib2R5LSIuY29uY2F0KHRoaXMuX3VpZCkKICAgIH07CiAgICAvKiogRGVib3VuY2UgZnVuY3Rpb24gdXNlZCBhcyB3aW5kb3cgcmVzaXplIGNhbGxiYWNrLiAqLwoKICAgIHRoaXMuX3Jlc2l6ZUNhbGxiYWNrID0gdGhyb3R0bGUoZnVuY3Rpb24gKF9ldmVudCkgewogICAgICByZXR1cm4gX3RoaXMub25XaW5kb3dSZXNpemUoX2V2ZW50KTsKICAgIH0sIDMwMCwgdHJ1ZSk7CiAgICAvKiogSW5zdGFuY2Ugb2YgUmVzaXplT2JzZXJ2ZXIuICovCgogICAgdGhpcy5fcmVzaXplT2JzZXJ2ZXIgPSBudWxsOwogICAgLyoqIFN0b3JlcyBmaXJzdCBhbmQgbGFzdCBmb2N1c2FibGUgZWxlbWVudHMgaW4gd2luZG93LiAqLwoKICAgIHRoaXMuX2ZpcnN0TGFzdEZvY3VzYWJsZXMgPSB7CiAgICAgIGZpcnN0OiBudWxsLAogICAgICBsYXN0OiBudWxsCiAgICB9OwogICAgLyoqIGBoaWRlQWZ0ZXJgIHRpbWVvdXQgaWQuICovCgogICAgdGhpcy5faGlkZUFmdGVySWQgPSAtMTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuJGVsKTsKCiAgICBpZiAodGhpcy5oaWRlT25XaW5kb3dSZXNpemUpIHsKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuX3Jlc2l6ZUNhbGxiYWNrLCBmYWxzZSk7CiAgICB9CgogICAgaWYgKHRoaXMuaGlkZU9uV2luZG93TW91c2Vkb3duKSB7CiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm9uV2luZG93TW91c2Vkb3duLCBmYWxzZSk7CiAgICB9CgogICAgaWYgKHRoaXMudmlzaWJsZSkgewogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMyLnNob3coKTsKICAgICAgfSk7CiAgICB9CiAgfSwKICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgdGhpcy5fZmlyc3RMYXN0Rm9jdXNhYmxlcyA9IG51bGw7CgogICAgaWYgKHRoaXMuaGlkZU9uV2luZG93UmVzaXplKSB7CiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLl9yZXNpemVDYWxsYmFjayk7CiAgICB9CgogICAgaWYgKHRoaXMuaGlkZU9uV2luZG93TW91c2Vkb3duKSB7CiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm9uV2luZG93TW91c2Vkb3duKTsKICAgIH0KCiAgICB0aGlzLmNsZWFySGlkZUFmdGVyVGltZW91dCgpOwogICAgdGhpcy5kZXN0cm95UmVzaXplT2JzZXJ2ZXIoKTsKICB9LAogIGRlc3Ryb3llZDogZnVuY3Rpb24gZGVzdHJveWVkKCkgewogICAgdGhpcy4kZWwucmVtb3ZlKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBzaG93OiBmdW5jdGlvbiBzaG93KF9hbmltYXRpb25JbikgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5pc1Zpc2libGUpIHsKICAgICAgICB2YXIgcGFyZW50V2luZG93ID0gdGhpcy5maW5kUGFyZW50QnlOYW1lKCdmLXdpbmRvdycpOwoKICAgICAgICBpZiAocGFyZW50V2luZG93KSB7CiAgICAgICAgICB0aGlzLmRaSW5kZXggPSBwYXJlbnRXaW5kb3cuZFpJbmRleCArIDI7CgogICAgICAgICAgdGhpcy5fdXBkYXRlU3R5bGUoewogICAgICAgICAgICB6SW5kZXg6IHRoaXMuZFpJbmRleAogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoX2FuaW1hdGlvbkluKSB7CiAgICAgICAgICB0aGlzLmRBbmltYXRpb25JbiA9IF9hbmltYXRpb25JbjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5kQW5pbWF0aW9uSW4gPSB0aGlzLmFuaW1hdGlvbkluOwogICAgICAgIH0KCiAgICAgICAgc2V0UmVjZWl2ZUZvY3VzRnJvbUF0dHIodGhpcy5faWRzLmNvbXApOwogICAgICAgIHRoaXMuX2ZpcnN0TGFzdEZvY3VzYWJsZXMuZmlyc3QgPSBudWxsOwogICAgICAgIHRoaXMuX2ZpcnN0TGFzdEZvY3VzYWJsZXMubGFzdCA9IG51bGw7CiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0cnVlOwogICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGdldENvbXB1dGVkU3R5bGUoX3RoaXMzLiRlbCwgX3RoaXMzLl93aW5kb3dTdHlsZSk7CgogICAgICAgICAgX3RoaXMzLnNldFBvc2l0aW9uKCk7IC8vIHRoaXMuZm9jdXMoKTsKCgogICAgICAgICAgX3RoaXMzLmNyZWF0ZVJlc2l6ZU9ic2VydmVyKCk7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5zdGFydEhpZGVBZnRlclRpbWVvdXQoKTsKICAgICAgfQogICAgfSwKICAgIGhpZGU6IGZ1bmN0aW9uIGhpZGUoX2FuaW1hdGlvbk91dCwgX2J5T3ZlcmxheSkgewogICAgICBpZiAodGhpcy5pc1Zpc2libGUpIHsKICAgICAgICBpZiAoIV9ieU92ZXJsYXkpIHsKICAgICAgICAgIGlmIChfYW5pbWF0aW9uT3V0KSB7CiAgICAgICAgICAgIHRoaXMuZEFuaW1hdGlvbk91dCA9IF9hbmltYXRpb25PdXQ7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmRBbmltYXRpb25PdXQgPSB0aGlzLmFuaW1hdGlvbk91dDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmRXaXRoT3ZlcmxheSAmJiAhX2J5T3ZlcmxheSkgewogICAgICAgICAgdGhpcy4kcmVmcy5vdmVybGF5LmhpZGUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5kZXN0cm95UmVzaXplT2JzZXJ2ZXIoKTsKICAgICAgICAgIHRoaXMuaXNWaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICB0aGlzLiRlbWl0KCd3aW5kb3ctaGlkZScpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuRm9jdXModGhpcy5faWRzLmNvbXApOwogICAgICB9CiAgICB9LAogICAgdG9nZ2xlOiBmdW5jdGlvbiB0b2dnbGUoKSB7CiAgICAgIGlmICghdGhpcy5pc1Zpc2libGUpIHsKICAgICAgICB0aGlzLnNob3coKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmhpZGUoKTsKICAgICAgfQogICAgfSwKCiAgICAvKioKICAgICAqIEZvY3VzIGVsZW1lbnQgd2l0aCBgZGF0YS1mb2N1c2AgYXR0cmlidXRlIG9yIGZvY3VzIGAuZG9jYCBieSBkZWZhdWx0LgogICAgICovCiAgICBmb2N1czogZnVuY3Rpb24gZm9jdXMoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIGZvY3VzRWxlbSA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWZvY3VzXScpOwogICAgICB2YXIgaW5wdXRFbGVtID0gbnVsbDsKCiAgICAgIGlmIChmb2N1c0VsZW0pIHsKICAgICAgICAvLyB0cnkgdG8gZmluZCBlbGVtZW50IHdpdGggYG5hbWVgIGF0dHJpYnV0ZQogICAgICAgIGlucHV0RWxlbSA9IGZvY3VzRWxlbS5xdWVyeVNlbGVjdG9yKCdbbmFtZV0nKTsKCiAgICAgICAgaWYgKGlucHV0RWxlbSkgewogICAgICAgICAgaW5wdXRFbGVtLmZvY3VzKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvY3VzRWxlbS5mb2N1cygpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczQuJHJlZnMuZG9jLmZvY3VzKCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBzZXRQb3NpdGlvbjogZnVuY3Rpb24gc2V0UG9zaXRpb24oKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdmFyIHN0eWxlID0ge307CgogICAgICBpZiAodGhpcy5pc1Zpc2libGUpIHsKICAgICAgICBpZiAodGhpcy5kUG9zaXRpb24gPT09ICdmaXhlZCcpIHsKICAgICAgICAgIGlmICh0aGlzLmNlbnRlckhvcml6b250YWxseSkgewogICAgICAgICAgICB0aGlzLl9zZXRIYWxmTWFyZ2luKHN0eWxlKTsKCiAgICAgICAgICAgIHN0eWxlLmxlZnQgPSAnNTAlJzsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy5jZW50ZXJWZXJ0aWNhbGx5KSB7CiAgICAgICAgICAgIHRoaXMuX3NldEhhbGZNYXJnaW4oc3R5bGUsIHRydWUpOwoKICAgICAgICAgICAgc3R5bGUudG9wID0gJzUwJSc7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aGlzLl91cGRhdGVTdHlsZShzdHlsZSk7CgogICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzNS5jb3JyZWN0UG9zaXRpb25BbmRTaXplKCk7CiAgICAgICAgfSk7IC8vIGRlZmVyKCgpID0+IHRoaXMuY29ycmVjdFBvc2l0aW9uQW5kU2l6ZSgpKTsKICAgICAgfQogICAgfSwKICAgIGNvcnJlY3RQb3NpdGlvbkFuZFNpemU6IGZ1bmN0aW9uIGNvcnJlY3RQb3NpdGlvbkFuZFNpemUoKSB7CiAgICAgIHZhciByZWN0OyAvLyBsZXQgYXR0YWNoTWFyZ2luOwogICAgICAvLyBsZXQgcG9zOwoKICAgICAgdmFyIGNzcyA9IHt9OwogICAgICB2YXIgd2luZG93U3R5bGUgPSB0aGlzLl93aW5kb3dTdHlsZTsKCiAgICAgIGlmICghdGhpcy5pc1Zpc2libGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmRQb3NpdGlvbiA9PT0gJ2ZpeGVkJykgewogICAgICAgIHJlY3QgPSB0aGlzLiRlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCiAgICAgICAgaWYgKHRoaXMuY2VudGVySG9yaXpvbnRhbGx5KSB7CiAgICAgICAgICBpZiAod2luZG93U3R5bGUuX2hvckhhbGZNYXJnaW5TZXQgJiYgcmVjdC5sZWZ0IDwgMCkgewogICAgICAgICAgICBjc3MubWFyZ2luTGVmdCA9IDA7CiAgICAgICAgICAgIGNzcy5sZWZ0ID0gMDsKICAgICAgICAgICAgd2luZG93U3R5bGUuX2hvckhhbGZNYXJnaW5TZXQgPSBmYWxzZTsKICAgICAgICAgIH0gZWxzZSBpZiAoIXdpbmRvd1N0eWxlLl9ob3JIYWxmTWFyZ2luU2V0ICYmIHJlY3Qud2lkdGggPCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgpIHsKICAgICAgICAgICAgdGhpcy5fc2V0SGFsZk1hcmdpbihjc3MpOwoKICAgICAgICAgICAgY3NzLmxlZnQgPSAnNTAlJzsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmNlbnRlclZlcnRpY2FsbHkpIHsKICAgICAgICAgIGlmICh3aW5kb3dTdHlsZS5fdmVySGFsZk1hcmdpblNldCAmJiByZWN0LnRvcCA8PSAwKSB7CiAgICAgICAgICAgIGNzcy5tYXJnaW5Ub3AgPSAwOwogICAgICAgICAgICBjc3MudG9wID0gMDsKICAgICAgICAgICAgd2luZG93U3R5bGUuX3ZlckhhbGZNYXJnaW5TZXQgPSBmYWxzZTsKICAgICAgICAgIH0gZWxzZSBpZiAoIXdpbmRvd1N0eWxlLl92ZXJIYWxmTWFyZ2luU2V0ICYmIHJlY3QuaGVpZ2h0IDwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCkgewogICAgICAgICAgICB0aGlzLl9zZXRIYWxmTWFyZ2luKGNzcywgdHJ1ZSk7CgogICAgICAgICAgICBjc3MudG9wID0gJzUwJSc7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHJlY3QudG9wID4gMCkgewogICAgICAgICAgICB0aGlzLl9zZXRIYWxmTWFyZ2luKGNzcywgdHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aGlzLl91cGRhdGVTdHlsZShjc3MpOwogICAgICB9IGVsc2UgaWYgKHRoaXMuZFBvc2l0aW9uID09PSAnYWJzb2x1dGUnKSB7CiAgICAgICAgaWYgKHRoaXMuYXR0YWNoVG8gfHwgdGhpcy5hdHRhY2hUb1BvaW50KSB7CiAgICAgICAgICB2YXIgYXR0YWNoTWFyZ2luID0gdGhpcy5hdHRhY2hNYXJnaW47CiAgICAgICAgICByZWN0ID0gYXR0YWNoRWxlbVRvKHRoaXMuJGVsLCB0aGlzLmF0dGFjaFRvUG9pbnQgfHwgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLmF0dGFjaFRvKSwgdGhpcy5fZ2V0QWxpZ25tZW50KCksIHRoaXMuc3RheUluVmlld3BvcnQsIHsKICAgICAgICAgICAgdG9wOiBhdHRhY2hNYXJnaW5bMF0sCiAgICAgICAgICAgIHJpZ2h0OiBhdHRhY2hNYXJnaW5bMV0sCiAgICAgICAgICAgIGJvdHRvbTogYXR0YWNoTWFyZ2luWzJdLAogICAgICAgICAgICBsZWZ0OiBhdHRhY2hNYXJnaW5bM10KICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5hdHRhY2hUb1BvaW50ID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVSZXNpemVPYnNlcnZlcjogZnVuY3Rpb24gY3JlYXRlUmVzaXplT2JzZXJ2ZXIoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLl9yZXNpemVPYnNlcnZlcikgewogICAgICAgIHRoaXMuX3Jlc2l6ZU9ic2VydmVyID0gbmV3IFJlc2l6ZU9ic2VydmVyKHRocm90dGxlKGZ1bmN0aW9uIChfZW50cmllcykgewogICAgICAgICAgcmV0dXJuIF90aGlzNi5vblJlc2l6ZShfZW50cmllcyk7CiAgICAgICAgfSwgMzAwLCB0cnVlKSk7CgogICAgICAgIHRoaXMuX3Jlc2l6ZU9ic2VydmVyLm9ic2VydmUodGhpcy4kZWwpOwogICAgICB9CiAgICB9LAogICAgZGVzdHJveVJlc2l6ZU9ic2VydmVyOiBmdW5jdGlvbiBkZXN0cm95UmVzaXplT2JzZXJ2ZXIoKSB7CiAgICAgIGlmICh0aGlzLl9yZXNpemVPYnNlcnZlcikgewogICAgICAgIHRoaXMuX3Jlc2l6ZU9ic2VydmVyLmRpc2Nvbm5lY3QoKTsKCiAgICAgICAgdGhpcy5fcmVzaXplT2JzZXJ2ZXIgPSBudWxsOwogICAgICB9CiAgICB9LAogICAgc3RhcnRIaWRlQWZ0ZXJUaW1lb3V0OiBmdW5jdGlvbiBzdGFydEhpZGVBZnRlclRpbWVvdXQoKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuaGlkZUFmdGVyID4gMCkgewogICAgICAgIHRoaXMuY2xlYXJIaWRlQWZ0ZXJUaW1lb3V0KCk7CiAgICAgICAgdGhpcy5faGlkZUFmdGVySWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzNy5oaWRlKCk7CiAgICAgICAgfSwgdGhpcy5oaWRlQWZ0ZXIpOwogICAgICB9CiAgICB9LAogICAgY2xlYXJIaWRlQWZ0ZXJUaW1lb3V0OiBmdW5jdGlvbiBjbGVhckhpZGVBZnRlclRpbWVvdXQoKSB7CiAgICAgIGlmICh0aGlzLl9oaWRlQWZ0ZXJJZCA+IC0xKSB7CiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX2hpZGVBZnRlcklkKTsKICAgICAgfQogICAgfSwKICAgIF9zZXRIYWxmTWFyZ2luOiBmdW5jdGlvbiBfc2V0SGFsZk1hcmdpbihfc3R5bGUsIF9zZXRUb3BNYXJnaW4pIHsKICAgICAgdmFyIG1hcmdpbiA9IHRoaXMuX2dldEhhbGZNYXJnaW4oX3NldFRvcE1hcmdpbik7CgogICAgICB2YXIgd2luZG93U3R5bGUgPSB0aGlzLl93aW5kb3dTdHlsZTsKICAgICAgdmFyIHN0eWxlOwoKICAgICAgaWYgKG1hcmdpbikgewogICAgICAgIHN0eWxlID0gX3N0eWxlIHx8IHRoaXMuJGVsLnN0eWxlOwoKICAgICAgICBpZiAoX3NldFRvcE1hcmdpbikgewogICAgICAgICAgc3R5bGUubWFyZ2luVG9wID0gbWFyZ2luOwogICAgICAgICAgd2luZG93U3R5bGUuX3ZlckhhbGZNYXJnaW5TZXQgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdHlsZS5tYXJnaW5MZWZ0ID0gbWFyZ2luOwogICAgICAgICAgd2luZG93U3R5bGUuX2hvckhhbGZNYXJnaW5TZXQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIF9nZXRIYWxmTWFyZ2luOiBmdW5jdGlvbiBfZ2V0SGFsZk1hcmdpbihfZ2V0VG9wTWFyZ2luKSB7CiAgICAgIHZhciB3aW5kb3dTdHlsZSA9IHRoaXMuX3dpbmRvd1N0eWxlOwogICAgICB2YXIgY2xpZW50SGVpZ2h0ID0gdGhpcy4kZWwuY2xpZW50SGVpZ2h0OwoKICAgICAgaWYgKHdpbmRvd1N0eWxlLmhlaWdodCA9PT0gJ2F1dG8nKSB7CiAgICAgICAgd2luZG93U3R5bGUuaGVpZ2h0ID0gIiIuY29uY2F0KGNsaWVudEhlaWdodCwgInB4Iik7CiAgICAgIH0KCiAgICAgIHZhciBsYXUgPSBnZXRMZW5ndGhBbmRVbml0KCAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmVzdGVkLXRlcm5hcnkKICAgICAgX2dldFRvcE1hcmdpbiA/IHBhcnNlSW50KHdpbmRvd1N0eWxlLmhlaWdodCwgMTApID8gIiIuY29uY2F0KGNsaWVudEhlaWdodCwgInB4IikgOiB3aW5kb3dTdHlsZS5tYXhIZWlnaHQgOiBwYXJzZUludCh3aW5kb3dTdHlsZS5tYXhXaWR0aCwgMTApID8gd2luZG93U3R5bGUubWF4V2lkdGggOiB3aW5kb3dTdHlsZS53aWR0aCk7CgogICAgICBpZiAobGF1LmxlbikgewogICAgICAgIHJldHVybiAtKGxhdS5sZW4gLyAyKSArIGxhdS51bml0OwogICAgICB9CgogICAgICByZXR1cm4gJyc7CiAgICB9LAogICAgX3VwZGF0ZVN0eWxlOiBmdW5jdGlvbiBfdXBkYXRlU3R5bGUoX2NzcykgewogICAgICB0aGlzLnN0eWxlID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLnN0eWxlKSwgX2Nzcyk7CiAgICB9LAogICAgX2dldEFsaWdubWVudDogZnVuY3Rpb24gX2dldEFsaWdubWVudCgpIHsKICAgICAgdmFyIGFsaWdubWVudCA9IFsnbHQnLCAnbGInXTsKICAgICAgdmFyIGF0dGFjaFBvc2l0aW9uID0gdGhpcy5hdHRhY2hQb3NpdGlvbjsKICAgICAgdmFyIHBvczsKCiAgICAgIGlmIChhdHRhY2hQb3NpdGlvbikgewogICAgICAgIGlmIChhdHRhY2hQb3NpdGlvbi5pbmRleE9mKCdhdXRvJykgPiAtMSkgewogICAgICAgICAgaWYgKHRoaXMuYXR0YWNoVG9Qb2ludCkgewogICAgICAgICAgICBwb3MgPSBnZXRBdHRhY2hQb3NpdGlvbkJ5UmVjdHMoZ2V0RWxlbVJlY3QodGhpcy4kZWwpLCB7CiAgICAgICAgICAgICAgd2lkdGg6IDEsCiAgICAgICAgICAgICAgaGVpZ2h0OiAxLAogICAgICAgICAgICAgIGxlZnQ6IHRoaXMuYXR0YWNoVG9Qb2ludFswXSwKICAgICAgICAgICAgICB0b3A6IHRoaXMuYXR0YWNoVG9Qb2ludFsxXQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hdHRhY2hUbykgewogICAgICAgICAgICBwb3MgPSBnZXRBdHRhY2hQb3NpdGlvbih0aGlzLiRlbCwgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLmF0dGFjaFRvKSk7CiAgICAgICAgICB9CgogICAgICAgICAgYXR0YWNoUG9zaXRpb24gPSBnZXRBdXRvQXR0YWNoUG9zaXRpb24ocG9zLCBhdHRhY2hQb3NpdGlvbiwgdGhpcy5wcmVmZXJyZWRBdHRhY2hQb3NpdGlvbik7CiAgICAgICAgfQoKICAgICAgICBhbGlnbm1lbnQgPSBnZXRBbGlnbm1lbnQoYXR0YWNoUG9zaXRpb24pOwogICAgICB9CgogICAgICByZXR1cm4gYWxpZ25tZW50OwogICAgfSwKCiAgICAvKioKICAgICAqIEByZXR1cm4ge2Jvb2xlYW59CiAgICAgKi8KICAgIGlzQ2hpbGRXaW5kb3dPcGVuZWQ6IGZ1bmN0aW9uIGlzQ2hpbGRXaW5kb3dPcGVuZWQoKSB7CiAgICAgIHZhciBvcGVuZWRXaW5kb3cgPSB0aGlzLmZpbmRDaGlsZEJ5TmFtZSgnZi13aW5kb3cnLCBmYWxzZSwgZnVuY3Rpb24gKF9jb21wb25lbnQpIHsKICAgICAgICByZXR1cm4gX2NvbXBvbmVudC5pc1Zpc2libGU7CiAgICAgIH0pOwogICAgICByZXR1cm4gISFvcGVuZWRXaW5kb3c7CiAgICB9LAogICAgb25XaW5kb3dSZXNpemU6IGZ1bmN0aW9uIG9uV2luZG93UmVzaXplKCkgewogICAgICBpZiAodGhpcy5pc1Zpc2libGUpIHsKICAgICAgICBpZiAodGhpcy5oaWRlT25XaW5kb3dSZXNpemUpIHsKICAgICAgICAgIHRoaXMuaGlkZSgpOwogICAgICAgIH0KICAgICAgICAvKiBlbHNlIHsKICAgICAgICAgIHRoaXMuY29ycmVjdFBvc2l0aW9uQW5kU2l6ZSgpOwogICAgICAgIH0qLwoKICAgICAgfQogICAgfSwKCiAgICAvKioKICAgICAqIEBwYXJhbSB7TW91c2VFdmVudH0gX2V2ZW50CiAgICAgKi8KICAgIG9uV2luZG93TW91c2Vkb3duOiBmdW5jdGlvbiBvbldpbmRvd01vdXNlZG93bihfZXZlbnQpIHsKICAgICAgaWYgKHRoaXMuaXNWaXNpYmxlICYmIHRoaXMuaGlkZU9uV2luZG93TW91c2Vkb3duICYmICFfZXZlbnQudGFyZ2V0LmNsb3Nlc3QoIiMiLmNvbmNhdCh0aGlzLmlkKSkgJiYgIXRoaXMuaXNDaGlsZFdpbmRvd09wZW5lZCgpKSB7CiAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgIH0KICAgIH0sCgogICAgLyoqCiAgICAgKiBDYWxsZWQgYnkgUmVzaXplT2JzZXJ2ZXIgd2hlbiBGV2luZG93IGlzIHJlc2l6ZWQuCiAgICAgKi8KICAgIG9uUmVzaXplOiBmdW5jdGlvbiBvblJlc2l6ZSgpIHsKICAgICAgaWYgKHRoaXMuaXNWaXNpYmxlKSB7CiAgICAgICAgdGhpcy5jb3JyZWN0UG9zaXRpb25BbmRTaXplKCk7CiAgICAgIH0KICAgIH0sCiAgICBvbk92ZXJsYXlIaWRlOiBmdW5jdGlvbiBvbk92ZXJsYXlIaWRlKF9oaWRkZW5CeUNsaWNrKSB7CiAgICAgIHRoaXMuaGlkZSgnJywgdHJ1ZSwgX2hpZGRlbkJ5Q2xpY2spOwogICAgfSwKICAgIG9uQ29udHJvbHNDbGljazogZnVuY3Rpb24gb25Db250cm9sc0NsaWNrKF9ldmVudCkgewogICAgICBpZiAoX2V2ZW50LnRhcmdldC5jbG9zZXN0KCcuY2xvc2UtYnRuJykpIHsKICAgICAgICB0aGlzLmhpZGUoKTsKICAgICAgfQogICAgfSwKICAgIG9uS2V5dXA6IGZ1bmN0aW9uIG9uS2V5dXAoX2V2ZW50KSB7CiAgICAgIGlmICh0aGlzLmhpZGVPbkVzY2FwZUtleSkgewogICAgICAgIGlmIChpc0tleSgnRXNjYXBlJywgX2V2ZW50KSkgewogICAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgb25LZXlkb3duOiBmdW5jdGlvbiBvbktleWRvd24oX2V2ZW50KSB7CiAgICAgIGZvY3VzVHJhcChfZXZlbnQsIHRoaXMuJGVsLCB0aGlzLl9maXJzdExhc3RGb2N1c2FibGVzKTsKICAgIH0KICB9Cn07"},{"version":3,"mappings":"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IAlCA,gBAkCAC,aAlCA,EAkCAC,UAlCA,EAkCA;MACA;QACA;UACA;YACA;UACA,CAFA,MAEA;YACA;UACA;QACA;;QAEA;UACA;QACA,CAFA,MAEA;UACA;UACA;UAEA;QACA;;QAEAC;MACA;IACA,CAvDA;IAyDAC,MAzDA,oBAyDA;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA;IACA,CA/DA;;IAiEA;AACA;AACA;IACAC,KApEA,mBAoEA;MAAA;;MACA;MACA;;MAEA;QACA;QACAC;;QACA;UACAA;QACA,CAFA,MAEA;UACAC;QACA;MACA,CARA,MAQA;QACA;UACA;QACA,CAFA;MAGA;IACA,CArFA;IAuFAC,WAvFA,yBAuFA;MAAA;;MACA;;MAEA;QACA;UACA;YACA;;YACAtC;UACA;;UAEA;YACA;;YACAA;UACA;QACA;;QAEA;;QAEA;UACA;QACA,CAFA,EAfA,CAmBA;MACA;IACA,CA/GA;IAiHAuC,sBAjHA,oCAiHA;MACA,SADA,CAEA;MACA;;MACA;MACA;;MAEA;QACA;MACA;;MAEA;QACAC;;QAEA;UACA;YACAC;YACAA;YAEAC;UACA,CALA,MAKA;YACA;;YACAD;UACA;QACA;;QAEA;UACA;YACAA;YACAA;YAEAC;UACA,CALA,MAKA;YACA;;YACAD;UACA;;UAEA;YACA;UACA;QACA;;QAEA;MACA,CAhCA,MAgCA;QACA;UACA;UAEAD,oBACA,QADA,EAEA,2DAFA,EAGA,oBAHA,EAIA,mBAJA,EAKA;YACAlC,oBADA;YAEAqC,sBAFA;YAGAC,uBAHA;YAIArC;UAJA,CALA;UAaA;QACA;MACA;IACA,CAhLA;IAkLAsC,oBAlLA,kCAkLA;MAAA;;MACA;QACA;UAAA;QAAA;;QACA;MACA;IACA,CAvLA;IAyLAC,qBAzLA,mCAyLA;MACA;QACA;;QACA;MACA;IACA,CA9LA;IAgMAC,qBAhMA,mCAgMA;MAAA;;MACA;QACA;QAEA;UACA;QACA,CAFA,EAEA,cAFA;MAGA;IACA,CAxMA;IA0MAC,qBA1MA,mCA0MA;MACA;QACAC;MACA;IACA,CA9MA;IAgNAC,cAhNA,0BAgNAC,MAhNA,EAgNAC,aAhNA,EAgNA;MACA;;MACA;MACA;;MAEA;QACApD;;QAEA;UACAA;UACA0C;QACA,CAHA,MAGA;UACA1C;UACA0C;QACA;MACA;IACA,CAhOA;IAkOAW,cAlOA,0BAkOAC,aAlOA,EAkOA;MACA;MACA;;MAEA;QACAZ;MACA;;MAEA,4BACA;MACAY,gBACAC,6CACAC,YADA,UAEAd,qBAHA,GAIAa,qCACAb,oBADA,GAEAA,iBARA;;MAWA;QACA;MACA;;MACA;IACA,CAzPA;IA2PAe,YA3PA,wBA2PAC,IA3PA,EA2PA;MACA,6CACA,UADA,GAEAA,IAFA;IAIA,CAhQA;IAkQAC,aAlQA,2BAkQA;MACA;MACA;MACA;;MAEA;QACA;UACA;YACAC;cACApD,QADA;cAEAG,SAFA;cAGAJ,2BAHA;cAIAD;YAJA;UAMA,CAPA,MAOA;YACAsD;UACA;;UAEA/E;QACA;;QAEAgF;MACA;;MAEA;IACA,CA3RA;;IA6RA;AACA;AACA;IACAC,mBAhSA,iCAgSA;MACA;QAAA;MAAA;MAEA;IACA,CApSA;IAsSAC,cAtSA,4BAsSA;MACA;QACA;UACA;QACA;QAAA;AACA;AACA;;MACA;IACA,CA9SA;;IAgTA;AACA;AACA;IACAC,iBAnTA,6BAmTAC,MAnTA,EAmTA;MACA,IACA,kBACA,0BADA,IAEA,2CAFA,IAGA,2BAJA,EAKA;QACA;MACA;IACA,CA5TA;;IA8TA;AACA;AACA;IACAC,QAjUA,sBAiUA;MACA;QACA;MACA;IACA,CArUA;IAuUAC,aAvUA,yBAuUAC,cAvUA,EAuUA;MACA;IACA,CAzUA;IA2UAC,eA3UA,2BA2UAJ,MA3UA,EA2UA;MACA;QACA;MACA;IACA,CA/UA;IAiVAK,OAjVA,mBAiVAL,MAjVA,EAiVA;MACA;QACA;UACA;QACA;MACA;IACA,CAvVA;IAyVAM,SAzVA,qBAyVAN,MAzVA,EAyVA;MACAO;IACA;EA3VA;AAnQA","names":["attachElemTo","getAlignment","getAttachPosition","getAttachPositionByRects","getAutoAttachPosition","getElemRect","name","components","FOverlay","mixins","props","visible","type","default","title","noTitle","animationIn","animationOut","role","modal","popover","withHeader","withFooter","withOverlay","position","zIndex","attachTo","attachPosition","preferredAttachPosition","attachMargin","validator","hideAfter","centerHorizontally","centerVertically","stayInViewport","hideOnWindowResize","hideOnWindowMousedown","hideOnEscapeKey","data","id","isVisible","dPosition","dAnimationIn","dAnimationOut","dZIndex","dWithOverlay","style","computed","cssClass","watch","_value","created","top","left","width","maxWidth","minWidth","height","maxHeight","minHeight","_horHalfMarginSet","_verHalfMarginSet","comp","body","first","last","mounted","document","window","beforeDestroy","destroyed","methods","show","_animationIn","setReceiveFocusFromAttr","getComputedStyle","hide","_animationOut","_byOverlay","returnFocus","toggle","focus","inputElem","focusElem","setPosition","correctPositionAndSize","rect","css","windowStyle","right","bottom","createResizeObserver","destroyResizeObserver","startHideAfterTimeout","clearHideAfterTimeout","clearTimeout","_setHalfMargin","_style","_setTopMargin","_getHalfMargin","_getTopMargin","parseInt","clientHeight","_updateStyle","_css","_getAlignment","pos","alignment","isChildWindowOpened","onWindowResize","onWindowMousedown","_event","onResize","onOverlayHide","_hiddenByClick","onControlsClick","onKeyup","onKeydown","focusTrap"],"sourceRoot":"src/components/core/FWindow","sources":["FWindow.vue"],"sourcesContent":["<template>\n    <transition :enter-active-class=\"dAnimationIn\" :leave-active-class=\"dAnimationOut\">\n        <div\n            v-if=\"isVisible\"\n            :id=\"id\"\n            class=\"f-window\"\n            :class=\"cssClass\"\n            :style=\"style\"\n            :role=\"role\"\n            :aria-modal=\"modal\"\n            :aria-labelledby=\"_ids.title\"\n            :aria-describedby=\"_ids.body\"\n            @keyup=\"onKeyup\"\n            @keydown=\"onKeydown\"\n        >\n            <div ref=\"doc\" role=\"document\" tabindex=\"-1\" class=\"doc\">\n                <header v-if=\"withHeader\">\n                    <div :id=\"_ids.title\" class=\"title\">\n                        <!-- @slot Default to `title` prop -->\n                        <slot name=\"title\">\n                            <h2>{{ title }}</h2>\n                        </slot>\n                    </div>\n                    <div class=\"controls\" @click=\"onControlsClick\">\n                        <!-- @slot Default to `close-btn` button -->\n                        <slot name=\"controls\">\n                            <button class=\"btn close-btn same-size round light\" title=\"Close window\">\n                                <icon data=\"@/assets/svg/times.svg\" width=\"20\" height=\"20\" />\n                            </button>\n                        </slot>\n                    </div>\n                </header>\n\n                <div :id=\"_ids.body\" class=\"body\">\n                    <slot></slot>\n                </div>\n\n                <footer v-if=\"withFooter\">\n                    <slot name=\"footer\"></slot>\n                </footer>\n\n                <f-overlay\n                    v-if=\"dWithOverlay && isVisible\"\n                    ref=\"overlay\"\n                    :z-index=\"dZIndex - 1\"\n                    class=\"f-window-overlay\"\n                    :hide-on-click=\"hideOnEscapeKey\"\n                    @overlay-hide=\"onOverlayHide\"\n                />\n            </div>\n        </div>\n    </transition>\n</template>\n\n<script>\nimport { getLengthAndUnit, getComputedStyle } from '../../../utils/css.js';\nimport { getUniqueId, throttle } from '../../../utils/index.js';\nimport FOverlay from '../FOverlay/FOverlay.vue';\nimport { focusTrap, isKey, returnFocus, setReceiveFocusFromAttr } from '../../../utils/aria.js';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport { helpersMixin } from '../../../mixins/helpers.js';\nimport {\n    attachElemTo,\n    getAlignment,\n    getAttachPosition,\n    getAttachPositionByRects,\n    getAutoAttachPosition,\n    getElemRect,\n} from '../../../utils/DOM.js';\n\n/**\n * Basic window following WAI-ARIA practices.\n * Needs `resize-observer-polyfill` plugin.\n */\nexport default {\n    name: 'FWindow',\n\n    components: { FOverlay },\n\n    mixins: [helpersMixin],\n\n    props: {\n        /** Is window visible on initialization? */\n        visible: {\n            type: Boolean,\n            default: false,\n        },\n        /** Title of window rendered in header. */\n        title: {\n            type: String,\n            default: '',\n        },\n        /** Has window a title? */\n        noTitle: {\n            type: Boolean,\n            default: false,\n        },\n        /** Animation that starts when the window is just about to show. */\n        animationIn: {\n            type: String,\n            default: 'fade-enter-active',\n        },\n        /** Animation that starts when the window is just about to hide. */\n        animationOut: {\n            type: String,\n            default: 'fade-leave-active',\n        },\n        /** WAI-ARIA role. */\n        role: {\n            type: String,\n            default: 'dialog',\n        },\n        /** Is window a modal? */\n        modal: {\n            type: Boolean,\n            default: false,\n        },\n        /** Is window a popover? */\n        popover: {\n            type: Boolean,\n            default: false,\n        },\n        /** `<header>` will be rendered. */\n        withHeader: {\n            type: Boolean,\n            default: true,\n        },\n        /** `<footer>` will be rendered. */\n        withFooter: {\n            type: Boolean,\n            default: false,\n        },\n        /** `FOverlay` shows. */\n        withOverlay: {\n            type: Boolean,\n            default: true,\n        },\n        /** 'fixed' | 'absolute' */\n        position: {\n            type: String,\n            default: 'fixed',\n        },\n        /** `z-index` of window, if overlay is used, it has `z-index` `zIndex -1`. */\n        zIndex: {\n            type: Number,\n            default: 10,\n        },\n        /** CSS selector. If window is popover, it will be attached to elemnet given by this selector. */\n        attachTo: {\n            type: String,\n            default: '',\n        },\n        /**\n         * How to place popover to `attachTo` element. (`'top'`, `'right'`, `'bottom'`, `'left'`, `'auto'`, `'[lcrm][tcbm] [lcrm][tcbm]'`)\n         *\n         * @type {('top', 'right', 'bottom', 'left', 'auto', '[lcrm][tcbm] [lcrm][tcbm]')}\n         */\n        attachPosition: {\n            type: String,\n            default: '',\n        },\n        /**\n         * Prefered attach position, if `attachPosition` is `'auto'`. (`'top'`, `'right'`, `'bottom'`, `'left'`, `'auto'`, `'[lcrm][tcbm] [lcrm][tcbm]'`)\n         *\n         * @type {('top', 'right', 'bottom', 'left', 'auto', '[lcrm][tcbm] [lcrm][tcbm]')}\n         */\n        preferredAttachPosition: {\n            type: String,\n            default: '',\n        },\n        /**\n         * Margin of popover. (`[top, right, bottom, left]`)\n         *\n         * @type {[number, number, number, number]}\n         */\n        attachMargin: {\n            type: Array,\n            default() {\n                return [0, 0, 0, 0];\n            },\n            validator: function (_value) {\n                return _value.length === 4;\n            },\n        },\n        /** Hide window after this amout of milliseconds. 0 means no auto hiding. */\n        hideAfter: {\n            type: Number,\n            default: 0,\n        },\n        /** Center window horizontally. */\n        centerHorizontally: {\n            type: Boolean,\n            default: true,\n        },\n        /** Center window vertically. */\n        centerVertically: {\n            type: Boolean,\n            default: true,\n        },\n        /** Make window stay in viewport. */\n        stayInViewport: {\n            type: Boolean,\n            default: true,\n        },\n        /** Hide window when browser window is resized. */\n        hideOnWindowResize: {\n            type: Boolean,\n            default: false,\n        },\n        /** Hide window on browser window mousedown. */\n        hideOnWindowMousedown: {\n            type: Boolean,\n            default: false,\n        },\n        /** Hide window when escape key is pressed. */\n        hideOnEscapeKey: {\n            type: Boolean,\n            default: true,\n        },\n    },\n\n    data() {\n        return {\n            id: getUniqueId(),\n            isVisible: false,\n            dPosition: this.popover ? 'absolute' : this.position,\n            dAnimationIn: this.animationIn,\n            dAnimationOut: this.animationOut,\n            dZIndex: this.zIndex,\n            dWithOverlay: this.popover ? false : this.withOverlay,\n            style: {\n                zIndex: this.zIndex,\n            },\n        };\n    },\n\n    computed: {\n        cssClass() {\n            return {\n                'pos-absolute': this.dPosition === 'absolute',\n                'pos-fixed': this.dPosition === 'fixed',\n                'with-header': this.withHeader,\n                'with-footer': this.withFooter,\n                'no-title': this.noTitle,\n                modal: this.modal,\n                popover: this.popover,\n            };\n        },\n    },\n\n    watch: {\n        visible(_value) {\n            this.isVisible = _value;\n        },\n    },\n\n    created() {\n        /** Initial css values of window. */\n        this._windowStyle = {\n            top: 0,\n            left: 0,\n            width: 0,\n            maxWidth: 0,\n            minWidth: 0,\n            height: 0,\n            maxHeight: 0,\n            minHeight: 0,\n            /*\n            borderTopLeftRadius: 0,\n            borderTopRightRadius: 0,\n            borderBottomLeftRadius: 0,\n            borderBottomRightRadius: 0,\n            */\n            _horHalfMarginSet: false, // helper\n            _verHalfMarginSet: false, // helper\n        };\n        /** Various ids. */\n        this._ids = {\n            comp: `fwin-${this._uid}`,\n            title: `fwin-title-${this._uid}`,\n            body: `fwin-body-${this._uid}`,\n        };\n        /** Debounce function used as window resize callback. */\n        this._resizeCallback = throttle((_event) => this.onWindowResize(_event), 300, true);\n        /** Instance of ResizeObserver. */\n        this._resizeObserver = null;\n        /** Stores first and last focusable elements in window. */\n        this._firstLastFocusables = {\n            first: null,\n            last: null,\n        };\n        /** `hideAfter` timeout id. */\n        this._hideAfterId = -1;\n    },\n\n    mounted() {\n        document.body.appendChild(this.$el);\n\n        if (this.hideOnWindowResize) {\n            window.addEventListener('resize', this._resizeCallback, false);\n        }\n\n        if (this.hideOnWindowMousedown) {\n            window.addEventListener('mousedown', this.onWindowMousedown, false);\n        }\n\n        if (this.visible) {\n            this.$nextTick(() => {\n                this.show();\n            });\n        }\n    },\n\n    beforeDestroy() {\n        this._firstLastFocusables = null;\n\n        if (this.hideOnWindowResize) {\n            window.removeEventListener('resize', this._resizeCallback);\n        }\n\n        if (this.hideOnWindowMousedown) {\n            window.removeEventListener('mousedown', this.onWindowMousedown);\n        }\n\n        this.clearHideAfterTimeout();\n\n        this.destroyResizeObserver();\n    },\n\n    destroyed() {\n        this.$el.remove();\n    },\n\n    methods: {\n        show(_animationIn) {\n            if (!this.isVisible) {\n                const parentWindow = this.findParentByName('f-window');\n\n                if (parentWindow) {\n                    this.dZIndex = parentWindow.dZIndex + 2;\n                    this._updateStyle({ zIndex: this.dZIndex });\n                }\n\n                if (_animationIn) {\n                    this.dAnimationIn = _animationIn;\n                } else {\n                    this.dAnimationIn = this.animationIn;\n                }\n\n                setReceiveFocusFromAttr(this._ids.comp);\n\n                this._firstLastFocusables.first = null;\n                this._firstLastFocusables.last = null;\n\n                this.isVisible = true;\n\n                this.$nextTick(() => {\n                    getComputedStyle(this.$el, this._windowStyle);\n                    this.setPosition();\n                    // this.focus();\n                    this.createResizeObserver();\n                });\n\n                this.startHideAfterTimeout();\n            }\n        },\n\n        hide(_animationOut, _byOverlay) {\n            if (this.isVisible) {\n                if (!_byOverlay) {\n                    if (_animationOut) {\n                        this.dAnimationOut = _animationOut;\n                    } else {\n                        this.dAnimationOut = this.animationOut;\n                    }\n                }\n\n                if (this.dWithOverlay && !_byOverlay) {\n                    this.$refs.overlay.hide();\n                } else {\n                    this.destroyResizeObserver();\n                    this.isVisible = false;\n\n                    this.$emit('window-hide');\n                }\n\n                returnFocus(this._ids.comp);\n            }\n        },\n\n        toggle() {\n            if (!this.isVisible) {\n                this.show();\n            } else {\n                this.hide();\n            }\n        },\n\n        /**\n         * Focus element with `data-focus` attribute or focus `.doc` by default.\n         */\n        focus() {\n            const focusElem = this.$el.querySelector('[data-focus]');\n            let inputElem = null;\n\n            if (focusElem) {\n                // try to find element with `name` attribute\n                inputElem = focusElem.querySelector('[name]');\n                if (inputElem) {\n                    inputElem.focus();\n                } else {\n                    focusElem.focus();\n                }\n            } else {\n                this.$nextTick(() => {\n                    this.$refs.doc.focus();\n                });\n            }\n        },\n\n        setPosition() {\n            const style = {};\n\n            if (this.isVisible) {\n                if (this.dPosition === 'fixed') {\n                    if (this.centerHorizontally) {\n                        this._setHalfMargin(style);\n                        style.left = '50%';\n                    }\n\n                    if (this.centerVertically) {\n                        this._setHalfMargin(style, true);\n                        style.top = '50%';\n                    }\n                }\n\n                this._updateStyle(style);\n\n                this.$nextTick(() => {\n                    this.correctPositionAndSize();\n                });\n\n                // defer(() => this.correctPositionAndSize());\n            }\n        },\n\n        correctPositionAndSize() {\n            let rect;\n            // let attachMargin;\n            // let pos;\n            const css = {};\n            const windowStyle = this._windowStyle;\n\n            if (!this.isVisible) {\n                return;\n            }\n\n            if (this.dPosition === 'fixed') {\n                rect = this.$el.getBoundingClientRect();\n\n                if (this.centerHorizontally) {\n                    if (windowStyle._horHalfMarginSet && rect.left < 0) {\n                        css.marginLeft = 0;\n                        css.left = 0;\n\n                        windowStyle._horHalfMarginSet = false;\n                    } else if (!windowStyle._horHalfMarginSet && rect.width < document.documentElement.clientWidth) {\n                        this._setHalfMargin(css);\n                        css.left = '50%';\n                    }\n                }\n\n                if (this.centerVertically) {\n                    if (windowStyle._verHalfMarginSet && rect.top <= 0) {\n                        css.marginTop = 0;\n                        css.top = 0;\n\n                        windowStyle._verHalfMarginSet = false;\n                    } else if (!windowStyle._verHalfMarginSet && rect.height < document.documentElement.clientHeight) {\n                        this._setHalfMargin(css, true);\n                        css.top = '50%';\n                    }\n\n                    if (rect.top > 0) {\n                        this._setHalfMargin(css, true);\n                    }\n                }\n\n                this._updateStyle(css);\n            } else if (this.dPosition === 'absolute') {\n                if (this.attachTo || this.attachToPoint) {\n                    const attachMargin = this.attachMargin;\n\n                    rect = attachElemTo(\n                        this.$el,\n                        this.attachToPoint || document.querySelector(this.attachTo),\n                        this._getAlignment(),\n                        this.stayInViewport,\n                        {\n                            top: attachMargin[0],\n                            right: attachMargin[1],\n                            bottom: attachMargin[2],\n                            left: attachMargin[3],\n                        }\n                    );\n\n                    this.attachToPoint = null;\n                }\n            }\n        },\n\n        createResizeObserver() {\n            if (!this._resizeObserver) {\n                this._resizeObserver = new ResizeObserver(throttle((_entries) => this.onResize(_entries), 300, true));\n                this._resizeObserver.observe(this.$el);\n            }\n        },\n\n        destroyResizeObserver() {\n            if (this._resizeObserver) {\n                this._resizeObserver.disconnect();\n                this._resizeObserver = null;\n            }\n        },\n\n        startHideAfterTimeout() {\n            if (this.hideAfter > 0) {\n                this.clearHideAfterTimeout();\n\n                this._hideAfterId = setTimeout(() => {\n                    this.hide();\n                }, this.hideAfter);\n            }\n        },\n\n        clearHideAfterTimeout() {\n            if (this._hideAfterId > -1) {\n                clearTimeout(this._hideAfterId);\n            }\n        },\n\n        _setHalfMargin(_style, _setTopMargin) {\n            const margin = this._getHalfMargin(_setTopMargin);\n            const windowStyle = this._windowStyle;\n            let style;\n\n            if (margin) {\n                style = _style || this.$el.style;\n\n                if (_setTopMargin) {\n                    style.marginTop = margin;\n                    windowStyle._verHalfMarginSet = true;\n                } else {\n                    style.marginLeft = margin;\n                    windowStyle._horHalfMarginSet = true;\n                }\n            }\n        },\n\n        _getHalfMargin(_getTopMargin) {\n            const windowStyle = this._windowStyle;\n            const { clientHeight } = this.$el;\n\n            if (windowStyle.height === 'auto') {\n                windowStyle.height = `${clientHeight}px`;\n            }\n\n            const lau = getLengthAndUnit(\n                // eslint-disable-next-line no-nested-ternary\n                _getTopMargin\n                    ? parseInt(windowStyle.height, 10)\n                        ? `${clientHeight}px`\n                        : windowStyle.maxHeight\n                    : parseInt(windowStyle.maxWidth, 10)\n                    ? windowStyle.maxWidth\n                    : windowStyle.width\n            );\n\n            if (lau.len) {\n                return -(lau.len / 2) + lau.unit;\n            }\n            return '';\n        },\n\n        _updateStyle(_css) {\n            this.style = {\n                ...this.style,\n                ..._css,\n            };\n        },\n\n        _getAlignment() {\n            let alignment = ['lt', 'lb'];\n            let { attachPosition } = this;\n            let pos;\n\n            if (attachPosition) {\n                if (attachPosition.indexOf('auto') > -1) {\n                    if (this.attachToPoint) {\n                        pos = getAttachPositionByRects(getElemRect(this.$el), {\n                            width: 1,\n                            height: 1,\n                            left: this.attachToPoint[0],\n                            top: this.attachToPoint[1],\n                        });\n                    } else if (this.attachTo) {\n                        pos = getAttachPosition(this.$el, document.querySelector(this.attachTo));\n                    }\n\n                    attachPosition = getAutoAttachPosition(pos, attachPosition, this.preferredAttachPosition);\n                }\n\n                alignment = getAlignment(attachPosition);\n            }\n\n            return alignment;\n        },\n\n        /**\n         * @return {boolean}\n         */\n        isChildWindowOpened() {\n            const openedWindow = this.findChildByName('f-window', false, (_component) => _component.isVisible);\n\n            return !!openedWindow;\n        },\n\n        onWindowResize() {\n            if (this.isVisible) {\n                if (this.hideOnWindowResize) {\n                    this.hide();\n                } /* else {\n                    this.correctPositionAndSize();\n                }*/\n            }\n        },\n\n        /**\n         * @param {MouseEvent} _event\n         */\n        onWindowMousedown(_event) {\n            if (\n                this.isVisible &&\n                this.hideOnWindowMousedown &&\n                !_event.target.closest(`#${this.id}`) &&\n                !this.isChildWindowOpened()\n            ) {\n                this.hide();\n            }\n        },\n\n        /**\n         * Called by ResizeObserver when FWindow is resized.\n         */\n        onResize() {\n            if (this.isVisible) {\n                this.correctPositionAndSize();\n            }\n        },\n\n        onOverlayHide(_hiddenByClick) {\n            this.hide('', true, _hiddenByClick);\n        },\n\n        onControlsClick(_event) {\n            if (_event.target.closest('.close-btn')) {\n                this.hide();\n            }\n        },\n\n        onKeyup(_event) {\n            if (this.hideOnEscapeKey) {\n                if (isKey('Escape', _event)) {\n                    this.hide();\n                }\n            }\n        },\n\n        onKeydown(_event) {\n            focusTrap(_event, this.$el, this._firstLastFocusables);\n        },\n    },\n};\n</script>\n\n<style lang=\"scss\">\n@import 'style';\n</style>\n"]}]}